(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[620],{7456:function(e,n,t){"use strict";t.d(n,{_:function(){return r}});var r=function(e){return e.match("projectdivar")?"https://hambot.ham-san.net/d4dj/sig?url="+encodeURIComponent(e):e.match("d4-dj")?"https://hambot.ham-san.net/d4dj/d4db?url="+encodeURIComponent(e):e}},2974:function(e,n,t){"use strict";t.d(n,{M:function(){return c}});var r=t(5893),o=t(4096),i=t(4115),a=t(9490),s=t(7294),u=t(7216),c=function(){var e=(0,s.useContext)(u.A).event;return e?(0,r.jsxs)(o.k,{flexDirection:"column",children:[(0,r.jsx)(i.x,{fontWeight:"bold",fontSize:"3xl",textAlign:"center",children:e.name}),(0,r.jsx)(l,{startTime:e.startdate,rankEndTime:e.rank_end,resultsTime:e.rank_end})]}):null},l=function(e){var n=e.startTime,t=e.rankEndTime,u=e.resultsTime,c=(0,s.useState)("--:--"),l=c[0],d=c[1],f=(0,s.useState)(""),h=f[0],x=f[1],p=(0,s.useState)("-"),m=p[0],v=p[1],j=(0,s.useMemo)((function(){return Math.round(a.ou.fromISO(t).diff(a.ou.fromISO(n)).as("hours"))}),[n,t]);return(0,s.useEffect)((function(){var e=!1,r=function(){var r=a.ou.fromISO(t).diffNow(),o=a.ou.fromISO(u).diffNow(),i=Math.floor(a.ou.now().diff(a.ou.fromISO(n)).as("hours"));e||(r.as("hours")>0?(x("Time until end"),d(r.toFormat("hh:mm"))):o.as("hours")>0&&(x("Time until results"),d(o.toFormat("hh:mm"))),v("".concat(i>j?j:i," / ").concat(j," ").concat(i>j?"100":Math.round(i/j*100),"%")))};r();setInterval(r,3e4)}),[j]),(0,r.jsxs)(o.k,{flexDirection:"column",justifyContent:"center",children:[(0,r.jsxs)(i.x,{textAlign:"center",children:["Progress: ",m]}),(0,r.jsx)(i.x,{textAlign:"center",children:h}),(0,r.jsx)(i.x,{fontSize:"lg",fontWeight:"bold",textAlign:"center",children:l})]})}},7810:function(e,n,t){"use strict";t.d(n,{s:function(){return k}});var r=t(6265),o=t(5893),i=t(7294),a=t(3346),s=t(4013),u=t(4096),c=t(4115),l=t(9490),d=[1,2,3,10,50,100,500,1e3,2e3,5e3,1e4,2e4,3e4,5e4],f=t(9695),h=t.n(f),x=t(7216),p=t(3187),m=t(3451),v=t(980),j=function(){return(0,o.jsx)(u.k,{w:"full",alignItems:"center",justifyContent:"center",h:"full",children:(0,o.jsx)(v.Spinner,{size:"xl"})})},b=t(4279),g=t(4033);function y(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function S(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?y(Object(t),!0).forEach((function(n){(0,r.Z)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):y(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var k=function(e){var n=e.isSmall,t=(e.interval,e.isPlaying),r=void 0===t||t,f=e.onTierSelected,p=(0,i.useContext)(m.G),v=p.lbData,y=p.lastUpdated,k=(0,i.useContext)(g.X).changes,C=(0,i.useContext)(x.A).event,P=(0,s.G)(),D=(0,i.useMemo)((function(){var e=l.ou.fromJSDate(y).diffNow().as("milliseconds");return 0===e?"Just now":h()(e,{round:!0,largest:2})+" ago"}),[y]);if(!v)return(0,o.jsx)(j,{});var M=n||"base"===P||"sm"===P,I=M&&{display:"none"};return(0,o.jsxs)(u.k,{flexDir:"column",children:[(0,o.jsxs)(u.k,{flexDir:"column",children:[(0,o.jsx)(c.x,{fontSize:"4xl",fontWeight:"bold",children:"Muniboard"}),(0,o.jsxs)(c.x,{fontSize:"sm",as:"span",fontWeight:"normal",children:["Last Updated: ",D]})]}),(0,o.jsxs)(a.iA,{size:"sm",children:[(0,o.jsx)(a.hr,{children:(0,o.jsxs)(a.Tr,{children:[(0,o.jsx)(a.Th,{textAlign:"center",children:"Rank"}),(0,o.jsx)(a.Th,{children:"Name"}),(0,o.jsx)(a.Th,{children:"Points"}),(0,o.jsx)(a.Th,S(S({textAlign:"end"},I),{},{children:"Gap"})),(0,o.jsx)(a.Th,S(S({textAlign:"end"},I),{},{children:"Rate"})),(0,o.jsx)(a.Th,S(S({textAlign:"end",whiteSpace:"break-spaces"},I),{},{children:"Time to boat"})),(0,o.jsx)(a.Th,{children:"Last Updated"})]})}),(0,o.jsx)(a.p3,{children:v.map((function(e,n,t){var i,s,u,h,x,p;return(0,o.jsxs)(a.Tr,S(S({},r?w(e,null===k||void 0===k?void 0:k[e.rank],null===C||void 0===C?void 0:C.type):{}),{},{borderBottom:d.includes(e.rank)&&"2px solid",borderBottomColor:"gray.400",onClick:function(){return null===f||void 0===f?void 0:f(e.rank)},children:[(0,o.jsx)(a.Td,{textAlign:"center",children:(0,o.jsx)(T,{tier:e.rank,children:M?(0,b.a)(e.rank):e.rank})}),(0,o.jsxs)(a.Td,{children:[(0,o.jsx)(c.x,{fontSize:M?"sm":"md",overflow:M?"ellipsis":"unset",children:e.name}),(0,o.jsx)(c.x,S(S({fontSize:"xs"},I),{},{children:e.description}))]}),(0,o.jsxs)(a.Td,{children:[(0,o.jsx)(c.x,{fontSize:M?"sm":"md",children:e.points}),(null===k||void 0===k?void 0:k[e.rank])>0&&(0,o.jsxs)(c.x,{fontSize:"xs",children:["(+",null!==(i=k[e.rank])&&void 0!==i?i:0,")"]})]}),(0,o.jsx)(a.Td,S(S({isNumeric:!0},I),{},{children:n+1<t.length?e.points-(null===(s=t[n+1])||void 0===s?void 0:s.points):0})),(0,o.jsx)(a.Td,S(S({isNumeric:!0},I),{},{children:e.rate})),(0,o.jsx)(a.Td,S(S({isNumeric:!0},I),{},{children:n+1<t.length&&!isNaN(Number(null===(u=t[n+1])||void 0===u?void 0:u.rate))?O((e.points-(null===(h=t[n+1])||void 0===h?void 0:h.points))/(Number(null===(x=t[n+1])||void 0===x?void 0:x.rate)-Number("???"===e.rate?0:e.rate))*60*60*1e3):"-"})),(0,o.jsx)(a.Td,{children:(p=e.date,l.ou.fromISO(p).diffNow().as("minute")>-3?"Just now":l.ou.now().diff(l.ou.fromISO(p)).toFormat("hh:mm"))})]}),e.rank)}))})]})]})},w=function(e,n,t){var r,o;return null===(r=n>(null===(o=p.y[t])||void 0===o?void 0:o.maxPerGame))||void 0===r||r?{bg:"red.100"}:l.ou.fromISO(e.date).diffNow().as("minutes")<-10?{}:{bg:"gray.100"}},O=function(e){return isNaN(e)||e<0?"--:--":l.nL.fromMillis(e).toFormat("hh:mm")},T=(0,i.memo)((function(e){var n=e.tier,t=e.children,r=(0,i.useMemo)((function(){switch(n){case 1:return{fontSize:"xl",fontWeight:"bold",color:"yellow.400"};case 2:return{fontSize:"xl",fontWeight:"bold",color:"gray.400"};case 3:return{fontSize:"xl",fontWeight:"bold",color:"red.800"};case 10:case 50:case 100:case 500:case 1e3:case 2e3:case 5e3:case 1e4:case 2e4:case 3e4:case 5e4:return{fontSize:"xl",fontWeight:"bold"};default:return{}}}),[n]);return(0,o.jsx)(c.x,S(S({},r),{},{children:t||n}))}))},8024:function(e,n,t){"use strict";t.d(n,{W:function(){return u}});var r=t(5893),o=t(4096),i=t(8017),a=t(1664),s=t(1163),u=function(){var e=(0,s.useRouter)();return(0,r.jsxs)(o.k,{p:2,justifyContent:"center",children:[(0,r.jsx)(i.xu,{mx:4,p:2,rounded:"md",bg:"/"===e.pathname?"gray.200":"transparent",color:"/"===e.pathname?"blue.400":"black",fontSize:"lg",children:(0,r.jsx)(a.default,{href:"/",children:"Muniboard"})}),(0,r.jsx)(i.xu,{mx:4,p:2,rounded:"md",bg:"/graph"===e.pathname?"gray.200":"transparent",color:"/graph"===e.pathname?"blue.400":"black",fontSize:"lg",children:(0,r.jsx)(a.default,{href:"/graph",children:"Graph"})}),(0,r.jsx)(i.xu,{mx:4,p:2,rounded:"md",bg:"/live"===e.pathname?"gray.200":"transparent",color:"/live"===e.pathname?"blue.400":"black",fontSize:"lg",children:(0,r.jsx)(a.default,{href:"/live",children:"Live View"})})]})}},9567:function(e,n,t){"use strict";t.d(n,{z:function(){return v}});var r=t(5893),o=t(980),i=t(4096),a=t(4115),s=t(6185),u=t(9490),c=t(7294),l=t(4033),d=t(3451),f=t(8017),h=t(3346),x=t(3187),p=t(7216),m=function(e){var n,t=e.tier,o=(0,c.useContext)(l.X),i=o.pastUpdates,s=(o.changes,(0,c.useContext)(p.A).event),d=(0,c.useMemo)((function(){return s&&x.y[s.type]}),[s]),m=(0,c.useMemo)((function(){var e;return null===(e=i[t])||void 0===e?void 0:e.sort((function(e,n){return u.ou.fromISO(n.date).diff(u.ou.fromISO(e.date)).as("minutes")}))}),[i,d,t]);return(0,r.jsx)(f.xu,{h:"full",position:"relative",maxH:"600px",overflowX:"auto",children:(0,r.jsxs)(h.iA,{size:"sm",variant:"simple",children:[(0,r.jsx)(h.hr,{children:(0,r.jsxs)(h.Tr,{children:[(0,r.jsx)(h.Th,{children:"Change"}),(0,r.jsx)(h.Th,{children:"Points"}),(0,r.jsx)(h.Th,{children:"Date/Time"})]})}),(0,r.jsx)(h.p3,{children:null!==(n=null===m||void 0===m?void 0:m.map((function(e){return(0,r.jsxs)(h.Tr,{bg:d&&e.change>d.maxPerGame?"red.200":"unset",children:[(0,r.jsxs)(h.Td,{children:["+",e.change]}),(0,r.jsx)(h.Td,{children:e.point}),(0,r.jsx)(h.Td,{children:u.ou.fromISO(e.date).toFormat("HH:mm:ss dd/MM/yyyy")})]},e.date)})))&&void 0!==n?n:(0,r.jsx)(h.Tr,{children:(0,r.jsx)(h.Td,{colSpan:3,children:(0,r.jsx)(a.x,{textAlign:"center",children:"No data yet, Collecting Data..."})})})})]})})},v=function(e){var n=e.tier,t=e.onClose,f=(0,c.useContext)(l.X).changes,h=(0,c.useContext)(d.G).lbData,x=!!n,p=null===h||void 0===h?void 0:h.find((function(e){return e.rank===n}));return p?(0,r.jsxs)(o.Modal,{isOpen:x,size:"xl",onClose:t,children:[(0,r.jsx)(o.ModalOverlay,{}),(0,r.jsxs)(o.ModalContent,{children:[(0,r.jsxs)(o.ModalHeader,{children:["T",n," Details"]}),(0,r.jsx)(o.ModalCloseButton,{}),(0,r.jsx)(o.ModalBody,{children:(0,r.jsxs)(i.k,{flexDir:["column",null,"row"],children:[(0,r.jsxs)(i.k,{flexDir:"column",children:[(0,r.jsxs)(a.x,{children:[(0,r.jsx)(a.x,{fontWeight:"bold",as:"span",children:"Current player"}),": ",p.name]}),(0,r.jsxs)(a.x,{children:[(0,r.jsx)(a.x,{fontWeight:"bold",as:"span",children:"Points"}),": ",p.points]}),p.rate&&(0,r.jsxs)(a.x,{children:[(0,r.jsx)(a.x,{fontWeight:"bold",as:"span",children:"Rate"}),": ",p.rate]}),f[n]&&(0,r.jsxs)(a.x,{children:[(0,r.jsx)(a.x,{fontWeight:"bold",as:"span",children:"Last Update"}),": +",f[n]]}),(0,r.jsxs)(a.x,{children:[(0,r.jsx)(a.x,{fontWeight:"bold",as:"span",children:"Last Updated"}),": ",u.ou.fromISO(p.date).toFormat("HH:mm:ss dd/MM/yyyy")," ","(",u.ou.now().diff(u.ou.fromISO(p.date)).toFormat("hh:mm"),")"]})]}),(0,r.jsx)(i.k,{minH:"600px",children:(0,r.jsx)(m,{tier:n})})]})}),(0,r.jsx)(o.ModalFooter,{children:(0,r.jsx)(s.z,{colorScheme:"red",mr:3,onClick:t,children:"Close"})})]})]}):null}},3187:function(e,n,t){"use strict";t.d(n,{y:function(){return r}});var r={Medley:{maxPerGame:2700}}},7216:function(e,n,t){"use strict";t.d(n,{A:function(){return p},d:function(){return m}});var r=t(5893),o=t(809),i=t.n(o),a=t(2447),s=t(9490),u=t(9669),c=t.n(u),l=t(7456),d=function(){var e=(0,a.Z)(i().mark((function e(n){var t;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c().post((0,l._)("http://d4-dj-frontend.vercel.app/api/dbs"),{dbs:n});case 2:return t=e.sent,e.abrupt("return",n.map((function(e){return t.data.result[e]})));case 4:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),f=function(){var e=(0,a.Z)(i().mark((function e(){var n,t;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d(["EventMaster"]);case 2:return n=e.sent,t=Object.values(n[0]).find((function(e){return s.ou.fromSeconds(e.StartDate).diffNow().as("seconds")<0&&s.ou.fromSeconds(e.RankFixStartDate).diffNow().as("seconds")>0})),e.abrupt("return",{id:101,eventid:t.Id,name:t.Name,startdate:s.ou.fromSeconds(t.StartDate).toISO(),enddate:s.ou.fromSeconds(t.ResultAnnouncementDate).toISO(),rank_end:s.ou.fromSeconds(t.ReceptionCloseDate).toISO(),type:t.Type._name_});case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),h=t(4693),x=t(7294),p=(0,x.createContext)({}),m=function(e){var n=e.children,t=(0,x.useState)(),o=t[0],i=t[1];return(0,h.b)(f,i),(0,r.jsx)(p.Provider,{value:{event:o},children:n})}},4033:function(e,n,t){"use strict";t.d(n,{X:function(){return d},t:function(){return f}});var r=t(5893),o=t(6265),i=t(4121),a=t(5492),s=t(9490),u=t(7294),c=t(3451);function l(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}var d=(0,u.createContext)({}),f=function(e){var n=e.children,t=(0,u.useContext)(c.G).lbData,f=(0,u.useState)({}),h=f[0],x=f[1],p=(0,a._)("pastUpdates",{}),m=(0,i.Z)(p,2),v=m[0],j=m[1],b=(0,u.useRef)();return(0,u.useEffect)((function(){if(b.current){var e=[],n=t.map((function(n){var t,r=b.current.find((function(e){return e.rank===n.rank})),o=n.points-r.points,i=o>0?o:s.ou.fromISO(n.date).diffNow().as("minutes")>-4&&null!==(t=h[n.rank])&&void 0!==t?t:0;return o>0&&e.push([n.rank,{change:i,date:n.date,point:n.points}]),[n.rank,i]}));j((function(n){var t=function(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?l(Object(t),!0).forEach((function(n){(0,o.Z)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):l(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}({},n);return e.forEach((function(e){var n=(0,i.Z)(e,2),r=n[0],o=n[1];r in t||(t[r]=[]),t[r].push(o)})),t})),x(Object.fromEntries(n))}b.current=t}),[t]),(0,r.jsx)(d.Provider,{value:{changes:h,pastUpdates:v},children:n})}},3451:function(e,n,t){"use strict";t.d(n,{G:function(){return x},K:function(){return p}});var r=t(5893),o=t(809),i=t.n(o),a=t(2447),s=t(9999),u=t(9669),c=t.n(u),l=t(7456),d=function(){var e=(0,a.Z)(i().mark((function e(){var n;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([c().get((0,l._)("http://www.projectdivar.com/eventdata/t20")),c().get((0,l._)("http://www.projectdivar.com/eventdata/t50"))]);case 2:return n=e.sent,e.abrupt("return",n.map((function(e){return e.data})).reduce((function(e,n){return[].concat((0,s.Z)(e),(0,s.Z)(n))})).sort((function(e,n){return e.rank-n.rank})));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),f=t(7294),h=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1e3;return new Promise((function(n){return setTimeout(n,e)}))},x=(0,f.createContext)({}),p=function(e){var n=e.children,t=(0,f.useState)(),o=t[0],s=t[1],u=(0,f.useState)(),c=u[0],l=u[1],p=(0,f.useState)(2e4)[0];return(0,f.useEffect)((function(){var e=!1;(function(){var n=(0,a.Z)(i().mark((function n(){var t;return i().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(e){n.next=15;break}return n.prev=1,n.next=4,d();case 4:if(t=n.sent,!e){n.next=7;break}return n.abrupt("break",15);case 7:s(t),l(new Date);case 9:return n.prev=9,n.next=12,h(p);case 12:return n.finish(9);case 13:n.next=0;break;case 15:case"end":return n.stop()}}),n,null,[[1,,9,13]])})));return function(){return n.apply(this,arguments)}})()()}),[p]),(0,r.jsx)(x.Provider,{value:{lbData:o,lastUpdated:c},children:n})}},5492:function(e,n,t){"use strict";t.d(n,{_:function(){return s}});var r=t(7294),o=t(4047),i=t(2700),a=function(){function e(n){(0,o.Z)(this,e),this.key=n}return(0,i.Z)(e,[{key:"clear",value:function(){localStorage.removeItem(this.key)}},{key:"value",get:function(){try{var e=localStorage.getItem(this.key);return null!==e?JSON.parse(e):null}catch(n){return null}},set:function(e){if(null!==e){var n=JSON.stringify(e);localStorage.setItem(this.key,n)}else localStorage.removeItem(this.key)}}]),e}(),s=function(e){var n=this,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,o=new a(e),i=(0,r.useState)(o.value||t),s=i[0],u=i[1],c=function(e){var t="function"===typeof e?e.call(n,s):e;o.value=t,u(t)},l=function(e){return function(n){n.key===e&&u(JSON.parse(n.newValue||""))}};return(0,r.useEffect)((function(){return window.addEventListener("storage",l(e)),function(){window.removeEventListener("storage",l(e))}}),[e]),[s,c]}},4693:function(e,n,t){"use strict";t.d(n,{b:function(){return s}});var r=t(809),o=t.n(r),i=t(2447),a=t(7294),s=function(e,n){(0,a.useEffect)((function(){var t=!1;return function(){var r=(0,i.Z)(o().mark((function r(){var i;return o().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,"function"===typeof e?e():e;case 2:if(i=r.sent,!t){r.next=5;break}return r.abrupt("return");case 5:n(i);case 6:case"end":return r.stop()}}),r)})));return function(){return r.apply(this,arguments)}}()(),function(){t=!0}}),[e,n])}},4279:function(e,n,t){"use strict";t.d(n,{a:function(){return r}});var r=function(e){return e<1e3?"".concat(e):e<1e6?"".concat(Math.round(e/1e3*100)/100,"k"):"".concat(Math.round(e/1e6*100)/100,"M")}}}]);