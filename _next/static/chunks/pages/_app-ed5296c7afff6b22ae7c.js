(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[888,179],{9396:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return w}});var r=n(5893),u=n(6265),c=n(9008),a=(n(7294),n(4096)),o=n(9444),i=n(4115),s=n(8017),f=n(4536),p=n(5837),l=n(3451),d=n(2965),v=function(e){var t=e.providers,n=e.children;return t.reverse().map((function(e){return e})).reduce((function(e,t){return(0,r.jsx)(t,{children:e})}),n)},h=n(7933);function b(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function x(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?b(Object(n),!0).forEach((function(t){(0,u.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):b(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var m="/muni-web";var w=function(e){var t=e.Component,n=e.pageProps,u=n.isEventPage,b=n.title,w=(0,r.jsxs)(a.k,{flexDirection:"column",w:"full",minH:"100vh",alignItems:"stretch",children:[(0,r.jsxs)(a.k,{as:"main",flexDirection:"column",alignItems:"stretch",justifyContent:"stretch",flex:1,mb:20,children:[(0,r.jsx)(a.k,{justifyContent:"center",w:"full",bg:"gray.100",children:(0,r.jsxs)(a.k,{justifyContent:"space-between",alignItems:"center",w:["100%",null,"90%"],py:4,bg:"gray.100",children:[(0,r.jsx)(o.r,{href:"".concat(m,"/"),as:"a",_hover:{textDecor:"none"},children:(0,r.jsxs)(i.x,{fontSize:"2xl",fontWeight:"bold",children:[(0,r.jsx)(i.x,{as:"span",textDecor:"line-through",color:"red.400",children:"Muni"})," ","Towa Web (Please give me a proper name)"]})}),(0,r.jsx)(o.r,{href:"".concat(m,"/event"),_hover:{textDecor:"none"},as:"a",children:(0,r.jsx)(i.x,{fontSize:"lg",children:"View all events"})})]})}),(0,r.jsx)(s.xu,{maxW:["100%",null,"90%"],w:"full",mx:"auto",children:(0,r.jsx)(t,x({},n))})]}),(0,r.jsxs)(a.k,{as:"footer",py:"20px",justifyContent:"center",bg:"gray.100",children:["Powered by"," ",(0,r.jsx)(o.r,{href:"https://www.youtube.com/watch?v=M2wZs7eHHVo",children:(0,r.jsx)(i.x,{as:"span",color:"blue.500",cursor:"pointer",ml:"2",children:"\u3080\u306b"})})]})]});return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(c.default,{children:[(0,r.jsx)("title",{children:b||"Create \u3080\u306b App"}),(0,r.jsx)("link",{rel:"icon",href:"".concat(m,"/favicon.ico")}),(0,r.jsx)("meta",{property:"og:title",content:b||"Create \u3080\u306b App"}),!u&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("meta",{property:"og:url",content:"https://hamzaabamboo.github.io/muni-web"}),(0,r.jsx)("meta",{property:"og:image",content:"".concat(m,"/images/munihappy.png")}),(0,r.jsx)("meta",{property:"og:description",content:"Munimunimunimunimuni"})]})]}),(0,r.jsx)(f.x,{children:u?(0,r.jsx)(r.Fragment,{children:w}):(0,r.jsx)(v,{providers:[l.K,p.d,d.U,h.t],children:w})})]})}},7456:function(e,t,n){"use strict";n.d(t,{_n:function(){return a},bZ:function(){return o},x6:function(){return i}});var r=n(6265);function u(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?u(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):u(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var a=function(e){return e.match("projectdivar")?"https://hambot.ham-san.net/d4dj/sig?url="+encodeURIComponent(e):e.match("d4-dj")?"https://hambot.ham-san.net/d4dj/d4db?url="+encodeURIComponent(e):e},o=function(e){return c(c({},e),{},{eventid:e.eventid+2})},i=function(e){if("string"===typeof e.type)return e.type;switch(e.type){case 0:return"Poker";case 1:return"Bingo";case 2:return"Medley";case 3:return"Raid";default:return e.type}}},5837:function(e,t,n){"use strict";n.d(t,{A:function(){return d},d:function(){return v}});var r=n(5893),u=n(809),c=n.n(u),a=n(2447),o=n(9669),i=n.n(o),s=n(7456),f=function(){var e=(0,a.Z)(c().mark((function e(){var t;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i().get((0,s._n)("http://www.projectdivar.com/ev"));case 2:return t=e.sent,e.abrupt("return",(0,s.bZ)(t.data));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),p=n(4693),l=n(7294),d=(0,l.createContext)({}),v=function(e){var t=e.event,n=e.children,u=(0,l.useState)(t),c=u[0],a=u[1];return t||(0,p.b)(f,a),(0,r.jsx)(d.Provider,{value:{event:c||t},children:n})}},2965:function(e,t,n){"use strict";n.d(t,{V:function(){return x},U:function(){return m}});var r=n(5893),u=n(9999),c=n(809),a=n.n(c),o=n(2447),i=n(9669),s=n.n(i),f=n(7456),p=function(){var e=(0,o.Z)(a().mark((function e(t){var n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s().get((0,f._n)("http://www.projectdivar.com/eventdata/t20?all=true&event=".concat(t-2)));case 2:return n=e.sent,e.abrupt("return",n.data.sort((function(e,t){return e.id-t.id})).map(f.bZ));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),l=n(4693),d=n(9490),v=n(7294),h=n(5837),b=n(3451),x=(0,v.createContext)({}),m=function(e){var t=e.children,n=(0,v.useContext)(b.G).lbData,c=(0,v.useContext)(h.A).event,a=(0,v.useState)([]),o=a[0],i=a[1],s=(0,v.useRef)({}),f=(0,v.useCallback)((function(){return c?p(c.eventid):Promise.resolve([])}),[c]);return(0,l.b)(f,i),(0,v.useEffect)((function(){if(n){var e=n.filter((function(e){return!(s.current[e.rank]&&d.ou.fromISO(e.date).diff(s.current[e.rank]).as("seconds")<=0)&&(s.current[e.rank]=d.ou.fromISO(e.date),!0)}));e.length>0&&i((function(t){return[].concat((0,u.Z)(t),(0,u.Z)(e))}))}}),[n]),(0,r.jsx)(x.Provider,{value:{points:o},children:t})}},7933:function(e,t,n){"use strict";n.d(t,{X:function(){return w},t:function(){return j}});var r,u=n(5893),c=n(9999),a=n(809),o=n.n(a),i=n(2447),s=n(9642),f=function(){(r=new s.Z("munimuni")).version(1).stores({leaderboardChanges:"++id, event, rank, date, points, change"})};try{f()}catch(g){console.log("fuck"),r.delete(),f()}var p=function(e){return(0,i.Z)(o().mark((function t(){var n,u=arguments;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.apply(void 0,u);case 3:return t.abrupt("return",t.sent);case 6:t.prev=6,t.t0=t.catch(0),n=t.t0,t.t1=n.name,t.next="OpenFailedError"===t.t1?12:17;break;case 12:return r.delete(),f(),t.next=16,e.apply(void 0,u);case 16:return t.abrupt("break",18);case 17:throw n;case 18:case"end":return t.stop()}}),t,null,[[0,6]])})))},l=p(function(){var e=(0,i.Z)(o().mark((function e(t){var n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.table("leaderboardChanges").where("event").equals(t).toArray();case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),d=p(function(){var e=(0,i.Z)(o().mark((function e(t){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",r.table("leaderboardChanges").bulkAdd(t));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),v=n(4693),h=n(9490),b=n(7294),x=n(5837),m=n(3451),w=(0,b.createContext)({}),j=function(e){var t=e.children,n=(0,b.useContext)(m.G).lbData,r=(0,b.useContext)(x.A).event,a=(0,b.useState)({}),s=a[0],f=a[1],p=(0,b.useState)([]),j=p[0],g=p[1],y=(0,b.useRef)(),k=(0,b.useCallback)((0,i.Z)(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r){e.next=2;break}return e.abrupt("return",Promise.resolve([]));case 2:return e.abrupt("return",l(r.eventid));case 3:case"end":return e.stop()}}),e)}))),[r]);return(0,v.b)(k,g),(0,b.useEffect)((function(){if(r){if(y.current){var e=[],t=n.map((function(t){var n,u=y.current.find((function(e){return e.rank===t.rank})),c=t.points-u.points,a=c>0?c:h.ou.fromISO(t.date).diffNow().as("minutes")>-4&&null!==(n=s[t.rank])&&void 0!==n?n:0;return c>0&&e.push({event:r.eventid,rank:t.rank,change:a,date:h.ou.fromISO(t.date).toSeconds(),points:t.points}),[t.rank,a]}));g((function(t){return[].concat((0,c.Z)(t),e)})),d(e),f(Object.fromEntries(t))}y.current=n}}),[n,r]),(0,u.jsx)(w.Provider,{value:{changes:s,pastUpdates:j},children:t})}},3451:function(e,t,n){"use strict";n.d(t,{G:function(){return v},K:function(){return h}});var r=n(5893),u=n(809),c=n.n(u),a=n(2447),o=n(9999),i=n(9669),s=n.n(i),f=n(7456),p=function(){var e=(0,a.Z)(c().mark((function e(){var t;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([s().get((0,f._n)("http://www.projectdivar.com/eventdata/t20")),s().get((0,f._n)("http://www.projectdivar.com/eventdata/t50"))]);case 2:return t=e.sent,e.abrupt("return",t.map((function(e){return e.data})).reduce((function(e,t){return[].concat((0,o.Z)(e),(0,o.Z)(t))})).sort((function(e,t){return e.rank-t.rank})).map(f.bZ));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),l=n(7294),d=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1e3;return new Promise((function(t){return setTimeout(t,e)}))},v=(0,l.createContext)({}),h=function(e){var t=e.lbData,n=e.children,u=(0,l.useState)(),o=u[0],i=u[1],s=(0,l.useState)(),f=s[0],h=s[1],b=(0,l.useState)(2e4)[0];return(0,l.useEffect)((function(){if(!t){var e=!1;(function(){var t=(0,a.Z)(c().mark((function t(){var n;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e){t.next=15;break}return t.prev=1,t.next=4,p();case 4:if(n=t.sent,!e){t.next=7;break}return t.abrupt("break",15);case 7:i(n),h(new Date);case 9:return t.prev=9,t.next=12,d(b);case 12:return t.finish(9);case 13:t.next=0;break;case 15:case"end":return t.stop()}}),t,null,[[1,,9,13]])})));return function(){return t.apply(this,arguments)}})()()}}),[b]),(0,r.jsx)(v.Provider,{value:{lbData:t||o,lastUpdated:f},children:n})}},4693:function(e,t,n){"use strict";n.d(t,{b:function(){return o}});var r=n(809),u=n.n(r),c=n(2447),a=n(7294),o=function(e,t){(0,a.useEffect)((function(){var n=!1;return function(){var r=(0,c.Z)(u().mark((function r(){var c;return u().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,"function"===typeof e?e():e;case 2:if(c=r.sent,!n){r.next=5;break}return r.abrupt("return");case 5:t(c);case 6:case"end":return r.stop()}}),r)})));return function(){return r.apply(this,arguments)}}()(),function(){n=!0}}),[e,t])}},6363:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/_app",function(){return n(9396)}])},4453:function(){}},function(e){var t=function(t){return e(e.s=t)};e.O(0,[774,809,285,351,577,433,412,314],(function(){return t(6363),t(2441)}));var n=e.O();_N_E=n}]);