(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[645],{9122:function(t,n,e){"use strict";e.r(n),e.d(n,{default:function(){return x}});var r=e(5893),u=e(4121),a=e(7294),i=e(4115),o=e(8017),c=e(2974),s=e(3451),f=e(9490),l=e(9695),d=e.n(l),p=e(4263),h=e(8024),m=e(5277),v=e(6887);function x(){var t=(0,a.useContext)(s.G).lastUpdated,n=(0,a.useRef)(null),e=(0,m.tH)(n),l=(0,u.Z)(e,2),x=l[0],g=l[1],b=(0,a.useMemo)((function(){var n=f.ou.fromJSDate(t).diffNow().as("milliseconds");return 0===n?"Just now":d()(n,{round:!0,largest:2})+" ago"}),[t]);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(c.M,{}),(0,r.jsx)(h.W,{}),(0,r.jsx)(i.x,{color:"red.600",fontStyle:"italic",textAlign:"center",children:"This is super experimental, muni may break"}),(0,r.jsxs)(i.x,{textAlign:"center",children:["Last Updated: ",b]}),(0,r.jsx)(o.xu,{ref:n,w:"full",h:"600px",children:(0,r.jsx)(v.q,{width:x,height:g})}),(0,r.jsx)(p.I,{})]})}},7456:function(t,n,e){"use strict";e.d(n,{_:function(){return r}});var r=function(t){return t.match("projectdivar")?"https://hambot.ham-san.net/d4dj/sig?url="+encodeURIComponent(t):t.match("d4-dj")?"https://hambot.ham-san.net/d4dj/d4db?url="+encodeURIComponent(t):t}},2974:function(t,n,e){"use strict";e.d(n,{M:function(){return s}});var r=e(5893),u=e(4096),a=e(4115),i=e(9490),o=e(7294),c=e(7216),s=function(){var t=(0,o.useContext)(c.A).event;return t?(0,r.jsxs)(u.k,{flexDirection:"column",children:[(0,r.jsx)(a.x,{fontWeight:"bold",fontSize:"3xl",textAlign:"center",children:t.name}),(0,r.jsx)(f,{startTime:t.startdate,rankEndTime:t.rank_end,resultsTime:t.rank_end})]}):null},f=function(t){var n=t.startTime,e=t.rankEndTime,c=t.resultsTime,s=(0,o.useState)("--:--"),f=s[0],l=s[1],d=(0,o.useState)(""),p=d[0],h=d[1],m=(0,o.useState)("-"),v=m[0],x=m[1],g=(0,o.useMemo)((function(){return Math.round(i.ou.fromISO(e).diff(i.ou.fromISO(n)).as("hours"))}),[n,e]);return(0,o.useEffect)((function(){var t=!1,r=function(){var r=i.ou.fromISO(e).diffNow(),u=i.ou.fromISO(c).diffNow(),a=Math.floor(i.ou.now().diff(i.ou.fromISO(n)).as("hours"));t||(r.as("hours")>0?(h("Time until end"),l(r.toFormat("hh:mm"))):u.as("hours")>0&&(h("Time until results"),l(u.toFormat("hh:mm"))),x("".concat(a>g?g:a," / ").concat(g," ").concat(a>g?"100":Math.round(a/g*100),"%")))};r();setInterval(r,3e4)}),[g]),(0,r.jsxs)(u.k,{flexDirection:"column",justifyContent:"center",children:[(0,r.jsxs)(a.x,{textAlign:"center",children:["Progress: ",v]}),(0,r.jsx)(a.x,{textAlign:"center",children:p}),(0,r.jsx)(a.x,{fontSize:"lg",fontWeight:"bold",textAlign:"center",children:f})]})}},8024:function(t,n,e){"use strict";e.d(n,{W:function(){return c}});var r=e(5893),u=e(4096),a=e(8017),i=e(1664),o=e(1163),c=function(){var t=(0,o.useRouter)();return(0,r.jsxs)(u.k,{p:2,justifyContent:"center",children:[(0,r.jsx)(a.xu,{mx:4,p:2,rounded:"md",bg:"/"===t.pathname?"gray.200":"transparent",color:"/"===t.pathname?"blue.400":"black",fontSize:"lg",children:(0,r.jsx)(i.default,{href:"/",children:"Muniboard"})}),(0,r.jsx)(a.xu,{mx:4,p:2,rounded:"md",bg:"/graph"===t.pathname?"gray.200":"transparent",color:"/graph"===t.pathname?"blue.400":"black",fontSize:"lg",children:(0,r.jsx)(i.default,{href:"/graph",children:"Graph"})}),(0,r.jsx)(a.xu,{mx:4,p:2,rounded:"md",bg:"/live"===t.pathname?"gray.200":"transparent",color:"/live"===t.pathname?"blue.400":"black",fontSize:"lg",children:(0,r.jsx)(i.default,{href:"/live",children:"Live View"})})]})}},6887:function(t,n,e){"use strict";e.d(n,{q:function(){return h}});var r=e(5893),u=e(7294),a=e(7216),i=e(2965),o=e(8347),c=e(9801),s=e(9490),f=e(4279),l=e(4013),d=500,p=function(t){var n=t.points,e=t.startDate,a=t.endDate,i=t.isLive,p=void 0!==i&&i,h=t.width,m=t.height,v=void 0===m?600:m,x=(0,o.Z)(t,["points","startDate","endDate","isLive","width","height"]),g=(0,u.useRef)(),b=(0,u.useRef)(),w=(0,u.useRef)(),k=(0,u.useRef)(),S=(0,u.useRef)(),j=(0,u.useRef)(),y=(0,u.useRef)(),_=(0,u.useRef)(),T=(0,u.useRef)(),D=(0,u.useRef)(),I=(0,u.useRef)(),C=(0,l.G)(),O=x.isSmall||"base"===C||"sm"===C,A=(0,u.useMemo)((function(){return{top:20,right:20,bottom:30,left:O?45:60}}),[O]),E=(0,u.useMemo)((function(){var t=h-A.left-A.right;return t<0?0:t}),[A,h]),R=(0,u.useMemo)((function(){var t=v-A.top-A.bottom;return t<0?0:t}),[A,v]);function M(t){I.current=t.transform,D.current=I.current.rescaleX(b.current),w.current=c.LLu(D.current),L(),_.current.selectAll("path.line").attr("d",(function(t){return c.jvg().x((function(t){return D.current((0,c.ji_)(t.date))})).y((function(t){return k.current(t.points)}))(t[1])}))}(0,u.useEffect)((function(){c.Ys("#lbgraph").selectAll("*").remove(),T.current=c.sPX().scaleExtent([1,500]).extent([[0,0],[E,R]]).translateExtent([[0,-1/0],[E,1/0]]).on("zoom",M),g.current=c.Ys("#lbgraph").attr("width",E+A.left+A.right).attr("height",R+A.top+A.bottom).append("g").attr("transform","translate("+A.left+","+A.top+")"),b.current=c.Xf().range([0,E]),k.current=c.BYU().range([R,0]),D.current=b.current,y.current=g.current.append("clipPath").attr("id","graph").append("rect").attr("width",E).attr("height",R),g.current.append("g").attr("class","xAxis").attr("transform","translate(0,"+R+")"),g.current.append("g").attr("class","yAxis"),g.current.append("g").attr("class","xGrid").attr("transform","translate(0,"+R+")"),g.current.append("g").attr("class","yGrid"),w.current=c.LLu(b.current),S.current=c.y4O(k.current),j.current=c.PKp().range(["#e41a1c","#377eb8","#4daf4a","#984ea3","#ff7f00","#ffff33","#a65628","#f781bf","#999999"]),_.current=g.current.append("g").attr("clip-path","url(#graph)").attr("id","lines"),p||c.Ys("#lbgraph").call(T.current)}),[E,R,p]);var L=(0,u.useCallback)((function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];g.current.select(".xGrid").attr("color","lightgray").transition().duration(t?d:0).call(c.LLu(D.current).tickSize(-R).tickFormat((function(){return""}))),g.current.select(".yGrid").attr("color","lightgray").transition().duration(t?d:0).call(c.y4O(k.current).tickSize(-E).tickFormat((function(){return""}))),g.current.select(".xAxis").transition().duration(t?d:0).call(w.current),g.current.select(".yAxis").transition().duration(t?d:0).call(O?S.current.tickFormat((function(t){return(0,f.a)(t)})):S.current)}),[R,E,O]);return(0,u.useEffect)((function(){var t=s.ou.now().plus({minutes:30}),r=s.ou.fromISO(e),u=s.ou.fromISO(a),i=p?e&&s.ou.now().minus({hour:3}).diff(r).as("second")<0?r.toJSDate():s.ou.now().minus({hour:3}).toJSDate():e?r.toJSDate():c.VV$(n,(function(t){return(0,c.ji_)(t.date)})),o=p&&s.ou.now().plus({minutes:30}).diff(u).as("seconds")>0?u:t,f=[i,o];j.current=j.current.domain(new Set(n.map((function(t){return t.rank})))),b.current.domain(f),I.current&&(D.current=I.current.rescaleX(b.current),w.current=c.LLu(D.current)),k.current.domain([p?c.VV$(n.filter((function(t){return s.ou.fromISO(t.date).diff(s.ou.fromJSDate(i)).as("seconds")>0})),(function(t){return t.points})):0,c.Fp7(n,(function(t){return t.points}))]).nice();var l=c.Xxj(n,(function(t){return t.rank})),h=_.current.selectAll("path").data(l,(function(t){return t[0]}));h.enter().append("path").attr("class","line").attr("tier",(function(t){return t[0]})).attr("fill","none").attr("stroke",(function(t){return j.current(t[0])})).attr("stroke-width",2),h.exit().remove(),_.current.selectAll("path.line").transition().duration(d).attr("d",(function(t){return c.jvg().x((function(t){return D.current((0,c.ji_)(t.date))})).y((function(t){return k.current(t.points)}))(t[1])})),L(!0)}),[n,E,R,O]),(0,r.jsx)("svg",{id:"lbgraph"})},h=function(t){var n=t.width,e=t.height,o=t.isSmall,c=void 0!==o&&o,s=t.isLive,f=void 0!==s&&s,l=(0,u.useContext)(i.V).points,d=(0,u.useContext)(a.A).event;return(0,r.jsx)(p,{points:l,startDate:null===d||void 0===d?void 0:d.startdate,endDate:null===d||void 0===d?void 0:d.rank_end,width:n,height:e,isSmall:c,isLive:f})}},4263:function(t,n,e){"use strict";e.d(n,{I:function(){return s}});var r=e(5893),u=e(9999),a=e(6185),i=e(4096),o=e(7294),c=e(2965),s=function(){var t=(0,o.useContext)(c.V),n=t.displayTier,e=t.setDisplayTier,s=t.allTiers,f=(0,o.useMemo)((function(){return[{label:"Select All",tiers:s},{label:"Clear",tiers:[]},{label:"< T10",tiers:s.filter((function(t){return t<=10}))},{label:"< T20",tiers:s.filter((function(t){return t<=20}))},{label:"< T100",tiers:s.filter((function(t){return t<=100}))},{label:"> T500",tiers:s.filter((function(t){return t>=500}))}]}),[s]);return(0,r.jsxs)(i.k,{w:"full",flexWrap:"wrap",mx:"auto",children:[f.map((function(t){return(0,r.jsx)(a.z,{m:2,bg:"blue.200",onClick:function(){return e(t.tiers)},children:t.label},t.label)})),s.sort((function(t,n){return t-n})).map((function(t){return(0,r.jsxs)(a.z,{m:2,bg:null!==n&&void 0!==n&&n.includes(t)?"green.200":"gray.200",onClick:function(){return function(t){if(null!==n&&void 0!==n&&n.includes(t))return e((function(n){return n.filter((function(n){return n!==t}))}));e((function(n){return[].concat((0,u.Z)(n),[t])}))}(t)},children:["T",t]},t)}))]})}},7216:function(t,n,e){"use strict";e.d(n,{A:function(){return m},d:function(){return v}});var r=e(5893),u=e(809),a=e.n(u),i=e(2447),o=e(9490),c=e(9669),s=e.n(c),f=e(7456),l=function(){var t=(0,i.Z)(a().mark((function t(n){var e;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,s().post((0,f._)("http://d4-dj-frontend.vercel.app/api/dbs"),{dbs:n});case 2:return e=t.sent,t.abrupt("return",n.map((function(t){return e.data.result[t]})));case 4:case"end":return t.stop()}}),t)})));return function(n){return t.apply(this,arguments)}}(),d=function(){var t=(0,i.Z)(a().mark((function t(){var n,e;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,l(["EventMaster"]);case 2:return n=t.sent,e=Object.values(n[0]).find((function(t){return o.ou.fromSeconds(t.StartDate).diffNow().as("seconds")<0&&o.ou.fromSeconds(t.RankFixStartDate).diffNow().as("seconds")>0})),t.abrupt("return",{id:101,eventid:e.Id,name:e.Name,startdate:o.ou.fromSeconds(e.StartDate).toISO(),enddate:o.ou.fromSeconds(e.ResultAnnouncementDate).toISO(),rank_end:o.ou.fromSeconds(e.ReceptionCloseDate).toISO(),type:e.Type._name_});case 5:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),p=e(4693),h=e(7294),m=(0,h.createContext)({}),v=function(t){var n=t.children,e=(0,h.useState)(),u=e[0],a=e[1];return(0,p.b)(d,a),(0,r.jsx)(m.Provider,{value:{event:u},children:n})}},2965:function(t,n,e){"use strict";e.d(n,{V:function(){return g},U:function(){return b}});var r=e(5893),u=e(9999),a=e(4121),i=e(809),o=e.n(i),c=e(2447),s=e(9669),f=e.n(s),l=e(7456),d=function(){var t=(0,c.Z)(o().mark((function t(){var n;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,f().get((0,l._)("http://www.projectdivar.com/eventdata/t20?all=true&event=14"));case 2:return n=t.sent,t.abrupt("return",n.data.sort((function(t,n){return t.id-n.id})));case 4:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),p=e(5492),h=e(4693),m=e(9490),v=e(7294),x=e(3451),g=(0,v.createContext)({}),b=function(t){var n=t.children,e=(0,v.useContext)(x.G).lbData,i=(0,v.useState)([]),o=i[0],c=i[1],s=(0,p._)("displayTier",null),f=(0,a.Z)(s,2),l=f[0],b=f[1],w=(0,v.useState)([]),k=w[0],S=w[1],j=(0,v.useRef)({}),y=(0,v.useCallback)((function(t){var n=Array.from(new Set(t.map((function(t){return t.rank}))));S(n),null===l&&b(n),c(t)}),[]);(0,h.b)(d,y),(0,v.useEffect)((function(){if(e){var t=e.filter((function(t){return!(j.current[t.rank]&&m.ou.fromISO(t.date).diff(j.current[t.rank]).as("seconds")<=0)&&(j.current[t.rank]=m.ou.fromISO(t.date),!0)}));t.length>0&&c((function(n){return[].concat((0,u.Z)(n),(0,u.Z)(t))}))}}),[e]);var _=(0,v.useMemo)((function(){return l?o.filter((function(t){return l.includes(t.rank)})):o}),[o,l]);return(0,r.jsx)(g.Provider,{value:{points:_,displayTier:l,setDisplayTier:b,allTiers:k},children:n})}},3451:function(t,n,e){"use strict";e.d(n,{G:function(){return h},K:function(){return m}});var r=e(5893),u=e(809),a=e.n(u),i=e(2447),o=e(9999),c=e(9669),s=e.n(c),f=e(7456),l=function(){var t=(0,i.Z)(a().mark((function t(){var n;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Promise.all([s().get((0,f._)("http://www.projectdivar.com/eventdata/t20")),s().get((0,f._)("http://www.projectdivar.com/eventdata/t50"))]);case 2:return n=t.sent,t.abrupt("return",n.map((function(t){return t.data})).reduce((function(t,n){return[].concat((0,o.Z)(t),(0,o.Z)(n))})).sort((function(t,n){return t.rank-n.rank})));case 4:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),d=e(7294),p=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1e3;return new Promise((function(n){return setTimeout(n,t)}))},h=(0,d.createContext)({}),m=function(t){var n=t.children,e=(0,d.useState)(),u=e[0],o=e[1],c=(0,d.useState)(),s=c[0],f=c[1],m=(0,d.useState)(2e4)[0];return(0,d.useEffect)((function(){var t=!1;(function(){var n=(0,i.Z)(a().mark((function n(){var e;return a().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(t){n.next=15;break}return n.prev=1,n.next=4,l();case 4:if(e=n.sent,!t){n.next=7;break}return n.abrupt("break",15);case 7:o(e),f(new Date);case 9:return n.prev=9,n.next=12,p(m);case 12:return n.finish(9);case 13:n.next=0;break;case 15:case"end":return n.stop()}}),n,null,[[1,,9,13]])})));return function(){return n.apply(this,arguments)}})()()}),[m]),(0,r.jsx)(h.Provider,{value:{lbData:u,lastUpdated:s},children:n})}},5492:function(t,n,e){"use strict";e.d(n,{_:function(){return o}});var r=e(7294),u=e(4047),a=e(2700),i=function(){function t(n){(0,u.Z)(this,t),this.key=n}return(0,a.Z)(t,[{key:"clear",value:function(){localStorage.removeItem(this.key)}},{key:"value",get:function(){try{var t=localStorage.getItem(this.key);return null!==t?JSON.parse(t):null}catch(n){return null}},set:function(t){if(null!==t){var n=JSON.stringify(t);localStorage.setItem(this.key,n)}else localStorage.removeItem(this.key)}}]),t}(),o=function(t){var n=this,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,u=new i(t),a=(0,r.useState)(u.value||e),o=a[0],c=a[1],s=function(t){var e="function"===typeof t?t.call(n,o):t;u.value=e,c(e)},f=function(t){return function(n){n.key===t&&c(JSON.parse(n.newValue||""))}};return(0,r.useEffect)((function(){return window.addEventListener("storage",f(t)),function(){window.removeEventListener("storage",f(t))}}),[t]),[o,s]}},4693:function(t,n,e){"use strict";e.d(n,{b:function(){return o}});var r=e(809),u=e.n(r),a=e(2447),i=e(7294),o=function(t,n){(0,i.useEffect)((function(){var e=!1;return function(){var r=(0,a.Z)(u().mark((function r(){var a;return u().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,"function"===typeof t?t():t;case 2:if(a=r.sent,!e){r.next=5;break}return r.abrupt("return");case 5:n(a);case 6:case"end":return r.stop()}}),r)})));return function(){return r.apply(this,arguments)}}()(),function(){e=!0}}),[t,n])}},4279:function(t,n,e){"use strict";e.d(n,{a:function(){return r}});var r=function(t){return t<1e3?"".concat(t):t<1e6?"".concat(Math.round(t/1e3*100)/100,"k"):"".concat(Math.round(t/1e6*100)/100,"M")}},9439:function(t,n,e){(window.__NEXT_P=window.__NEXT_P||[]).push(["/graph",function(){return e(9122)}])}},function(t){t.O(0,[774,809,351,269,879,392],(function(){return n=9439,t(t.s=n);var n}));var n=t.O();_N_E=n}]);