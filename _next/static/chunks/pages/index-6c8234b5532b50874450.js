(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{4219:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return p}});var r=t(5893),o=t(7294),i=t(5110),a=t(8017),s=t(2974),u=t(8024);var c=t(980),d=t(4115),l=t(4096),f=t(3346),h=t(6185),x=t(3451),m=function(e){var n=e.tier,t=e.onClose;!function(e){if(null==e)throw new TypeError("Cannot destructure undefined")}((0,o.useContext)(x.G));var i=!!n;return(0,r.jsxs)(c.Modal,{isOpen:i,onClose:t,children:[(0,r.jsx)(c.ModalOverlay,{}),(0,r.jsxs)(c.ModalContent,{children:[(0,r.jsxs)(c.ModalHeader,{children:["T",n," Details"]}),(0,r.jsx)(c.ModalCloseButton,{}),(0,r.jsxs)(c.ModalBody,{children:[(0,r.jsx)(d.x,{children:"No data yet, I'm lazy"}),(0,r.jsx)(l.k,{children:(0,r.jsx)(l.k,{children:(0,r.jsxs)(f.iA,{variant:"small",children:[(0,r.jsx)(f.hr,{children:(0,r.jsxs)(f.Tr,{children:[(0,r.jsx)(f.Th,{children:"Score"}),(0,r.jsx)(f.Th,{children:"Change"}),(0,r.jsx)(f.Th,{children:"Date/Time"})]})}),(0,r.jsx)(f.p3,{})]})})})]}),(0,r.jsx)(c.ModalFooter,{children:(0,r.jsx)(h.z,{colorScheme:"red",mr:3,onClick:t,children:"Close"})})]})]})};function p(){var e=(0,o.useState)(),n=e[0],t=e[1];return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(s.M,{}),(0,r.jsx)(u.W,{}),(0,r.jsxs)(a.xu,{px:2,maxW:["100%",null,"80%"],mx:"auto",children:[(0,r.jsx)(i.s,{interval:1e4,onTierSelected:function(e){t(e)}}),(0,r.jsx)(m,{tier:n,onClose:function(){t(void 0)}})]})]})}},7456:function(e,n,t){"use strict";t.d(n,{_:function(){return r}});var r=function(e){return e.match("projectdivar")?"https://hambot.ham-san.net/d4dj/sig?url="+encodeURIComponent(e):e.match("d4-dj")?"https://hambot.ham-san.net/d4dj/d4db?url="+encodeURIComponent(e):e}},2974:function(e,n,t){"use strict";t.d(n,{M:function(){return c}});var r=t(5893),o=t(4096),i=t(4115),a=t(9490),s=t(7294),u=t(7216),c=function(){var e=(0,s.useContext)(u.A).event;return e?(0,r.jsxs)(o.k,{flexDirection:"column",children:[(0,r.jsx)(i.x,{fontWeight:"bold",fontSize:"3xl",textAlign:"center",children:e.name}),(0,r.jsx)(d,{startTime:e.startdate,rankEndTime:e.rank_end,resultsTime:e.rank_end})]}):null},d=function(e){var n=e.startTime,t=e.rankEndTime,u=e.resultsTime,c=(0,s.useState)("--:--"),d=c[0],l=c[1],f=(0,s.useState)(""),h=f[0],x=f[1],m=(0,s.useState)("-"),p=m[0],v=m[1],j=(0,s.useMemo)((function(){return Math.round(a.ou.fromISO(t).diff(a.ou.fromISO(n)).as("hours"))}),[n,t]);return(0,s.useEffect)((function(){var e=!1,r=function(){var r=a.ou.fromISO(t).diffNow(),o=a.ou.fromISO(u).diffNow(),i=Math.floor(a.ou.now().diff(a.ou.fromISO(n)).as("hours"));e||(r.as("hours")>0?(x("Time until end"),l(r.toFormat("hh:mm"))):o.as("hours")>0&&(x("Time until results"),l(o.toFormat("hh:mm"))),v("".concat(i>j?j:i," / ").concat(j," ").concat(i>j?"100":Math.round(i/j*100),"%")))};r();setInterval(r,3e4)}),[j]),(0,r.jsxs)(o.k,{flexDirection:"column",justifyContent:"center",children:[(0,r.jsxs)(i.x,{textAlign:"center",children:["Progress: ",p]}),(0,r.jsx)(i.x,{textAlign:"center",children:h}),(0,r.jsx)(i.x,{fontSize:"lg",fontWeight:"bold",textAlign:"center",children:d})]})}},5110:function(e,n,t){"use strict";t.d(n,{s:function(){return w}});var r=t(6265),o=t(5893),i=t(7294),a=t(3346),s=t(4013),u=t(4096),c=t(4115),d=t(9490),l=[1,2,3,10,50,100,500,1e3,2e3,5e3,1e4,2e4,3e4,5e4],f=t(9695),h=t.n(f),x=t(7216),m={Medley:{maxPerGame:2700}},p=t(3451),v=t(980),j=function(){return(0,o.jsx)(u.k,{w:"full",alignItems:"center",justifyContent:"center",h:"full",children:(0,o.jsx)(v.Spinner,{size:"xl"})})},b=t(4279),g=t(4033);function S(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function k(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?S(Object(t),!0).forEach((function(n){(0,r.Z)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):S(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var w=function(e){var n=e.isSmall,t=(e.interval,e.isPlaying),r=void 0===t||t,f=e.onTierSelected,m=(0,i.useContext)(p.G),v=m.lbData,S=m.lastUpdated,w=(0,i.useContext)(g.X).changes,C=(0,i.useContext)(x.A).event,N=(0,s.G)(),M=(0,i.useMemo)((function(){var e=d.ou.fromJSDate(S).diffNow().as("milliseconds");return 0===e?"Just now":h()(e,{round:!0,largest:2})+" ago"}),[S]);if(!v)return(0,o.jsx)(j,{});var _=n||"base"===N||"sm"===N,D=_&&{display:"none"};return(0,o.jsxs)(u.k,{flexDir:"column",children:[(0,o.jsxs)(u.k,{flexDir:"column",children:[(0,o.jsx)(c.x,{fontSize:"4xl",fontWeight:"bold",children:"Muniboard"}),(0,o.jsxs)(c.x,{fontSize:"sm",as:"span",fontWeight:"normal",children:["Last Updated: ",M]})]}),(0,o.jsxs)(a.iA,{size:"sm",children:[(0,o.jsx)(a.hr,{children:(0,o.jsxs)(a.Tr,{children:[(0,o.jsx)(a.Th,{textAlign:"center",children:"Rank"}),(0,o.jsx)(a.Th,{children:"Name"}),(0,o.jsx)(a.Th,{children:"Points"}),(0,o.jsx)(a.Th,k(k({textAlign:"end"},D),{},{children:"Gap"})),(0,o.jsx)(a.Th,k(k({textAlign:"end"},D),{},{children:"Rate"})),(0,o.jsx)(a.Th,k(k({textAlign:"end",whiteSpace:"break-spaces"},D),{},{children:"Time to boat"})),(0,o.jsx)(a.Th,{children:"Last Updated"})]})}),(0,o.jsx)(a.p3,{children:v.map((function(e,n,t){var i,s,u,h,x,m;return(0,o.jsxs)(a.Tr,k(k({},r?y(e,null===w||void 0===w?void 0:w[e.rank],null===C||void 0===C?void 0:C.type):{}),{},{borderBottom:l.includes(e.rank)&&"2px solid",borderBottomColor:"gray.400",onClick:function(){return null===f||void 0===f?void 0:f(e.rank)},children:[(0,o.jsx)(a.Td,{textAlign:"center",children:(0,o.jsx)(O,{tier:e.rank,children:_?(0,b.a)(e.rank):e.rank})}),(0,o.jsxs)(a.Td,{children:[(0,o.jsx)(c.x,{fontSize:_?"sm":"md",overflow:_?"ellipsis":"unset",children:e.name}),(0,o.jsx)(c.x,k(k({fontSize:"xs"},D),{},{children:e.description}))]}),(0,o.jsxs)(a.Td,{children:[(0,o.jsx)(c.x,{fontSize:_?"sm":"md",children:e.points}),(null===w||void 0===w?void 0:w[e.rank])>0&&(0,o.jsxs)(c.x,{fontSize:"xs",children:["(+",null!==(i=w[e.rank])&&void 0!==i?i:0,")"]})]}),(0,o.jsx)(a.Td,k(k({isNumeric:!0},D),{},{children:n+1<t.length?e.points-(null===(s=t[n+1])||void 0===s?void 0:s.points):0})),(0,o.jsx)(a.Td,k(k({isNumeric:!0},D),{},{children:e.rate})),(0,o.jsx)(a.Td,k(k({isNumeric:!0},D),{},{children:n+1<t.length&&!isNaN(Number(null===(u=t[n+1])||void 0===u?void 0:u.rate))?T((e.points-(null===(h=t[n+1])||void 0===h?void 0:h.points))/(Number(null===(x=t[n+1])||void 0===x?void 0:x.rate)-Number(e.rate))*60*60*1e3):"-"})),(0,o.jsx)(a.Td,{children:(m=e.date,d.ou.fromISO(m).diffNow().as("minute")>-3?"Just now":d.ou.now().diff(d.ou.fromISO(m)).toFormat("hh:mm"))})]}),e.rank)}))})]})]})},y=function(e,n,t){var r,o;return null===(r=n>(null===(o=m[t])||void 0===o?void 0:o.maxPerGame))||void 0===r||r?{bg:"red.100"}:d.ou.fromISO(e.date).diffNow().as("minutes")<-10?{}:{bg:"gray.100"}},T=function(e){return isNaN(e)||e<0?"--:--":d.nL.fromMillis(e).toFormat("hh:mm")},O=(0,i.memo)((function(e){var n=e.tier,t=e.children,r=(0,i.useMemo)((function(){switch(n){case 1:return{fontSize:"xl",fontWeight:"bold",color:"yellow.400"};case 2:return{fontSize:"xl",fontWeight:"bold",color:"gray.400"};case 3:return{fontSize:"xl",fontWeight:"bold",color:"red.800"};case 10:case 50:case 100:case 500:case 1e3:case 2e3:case 5e3:case 1e4:case 2e4:case 3e4:case 5e4:return{fontSize:"xl",fontWeight:"bold"};default:return{}}}),[n]);return(0,o.jsx)(c.x,k(k({},r),{},{children:t||n}))}))},8024:function(e,n,t){"use strict";t.d(n,{W:function(){return u}});var r=t(5893),o=t(4096),i=t(8017),a=t(1664),s=t(1163),u=function(){var e=(0,s.useRouter)();return(0,r.jsxs)(o.k,{p:2,justifyContent:"center",children:[(0,r.jsx)(i.xu,{mx:4,p:2,rounded:"md",bg:"/"===e.pathname?"gray.200":"transparent",color:"/"===e.pathname?"blue.400":"black",fontSize:"lg",children:(0,r.jsx)(a.default,{href:"/",children:"Muniboard"})}),(0,r.jsx)(i.xu,{mx:4,p:2,rounded:"md",bg:"/graph"===e.pathname?"gray.200":"transparent",color:"/graph"===e.pathname?"blue.400":"black",fontSize:"lg",children:(0,r.jsx)(a.default,{href:"/graph",children:"Graph"})}),(0,r.jsx)(i.xu,{mx:4,p:2,rounded:"md",bg:"/live"===e.pathname?"gray.200":"transparent",color:"/live"===e.pathname?"blue.400":"black",fontSize:"lg",children:(0,r.jsx)(a.default,{href:"/live",children:"Live View"})})]})}},7216:function(e,n,t){"use strict";t.d(n,{A:function(){return m},d:function(){return p}});var r=t(5893),o=t(809),i=t.n(o),a=t(2447),s=t(9490),u=t(9669),c=t.n(u),d=t(7456),l=function(){var e=(0,a.Z)(i().mark((function e(n){var t;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c().post((0,d._)("http://d4-dj-frontend.vercel.app/api/dbs"),{dbs:n});case 2:return t=e.sent,e.abrupt("return",n.map((function(e){return t.data.result[e]})));case 4:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),f=function(){var e=(0,a.Z)(i().mark((function e(){var n,t;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l(["EventMaster"]);case 2:return n=e.sent,t=Object.values(n[0]).find((function(e){return s.ou.fromSeconds(e.StartDate).diffNow().as("seconds")<0&&s.ou.fromSeconds(e.RankFixStartDate).diffNow().as("seconds")>0})),e.abrupt("return",{id:101,eventid:t.Id,name:t.Name,startdate:s.ou.fromSeconds(t.StartDate).toISO(),enddate:s.ou.fromSeconds(t.ResultAnnouncementDate).toISO(),rank_end:s.ou.fromSeconds(t.ReceptionCloseDate).toISO(),type:t.Type._name_});case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),h=t(4693),x=t(7294),m=(0,x.createContext)({}),p=function(e){var n=e.children,t=(0,x.useState)(),o=t[0],i=t[1];return(0,h.b)(f,i),(0,r.jsx)(m.Provider,{value:{event:o},children:n})}},4033:function(e,n,t){"use strict";t.d(n,{X:function(){return s},t:function(){return u}});var r=t(5893),o=t(9490),i=t(7294),a=t(3451),s=(0,i.createContext)({}),u=function(e){var n=e.children,t=(0,i.useContext)(a.G).lbData,u=(0,i.useState)({}),c=u[0],d=u[1],l=(0,i.useRef)();return(0,i.useEffect)((function(){if(l.current){var e=t.map((function(e){var n,t=l.current.find((function(n){return n.rank===e.rank})),r=e.points-t.points;return[e.rank,r>0?r:o.ou.fromISO(e.date).diffNow().as("minutes")>-4&&null!==(n=c[e.rank])&&void 0!==n?n:0]}));d(Object.fromEntries(e))}l.current=t}),[t]),(0,r.jsx)(s.Provider,{value:{changes:c},children:n})}},3451:function(e,n,t){"use strict";t.d(n,{G:function(){return x},K:function(){return m}});var r=t(5893),o=t(809),i=t.n(o),a=t(2447),s=t(9999),u=t(9669),c=t.n(u),d=t(7456),l=function(){var e=(0,a.Z)(i().mark((function e(){var n;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([c().get((0,d._)("http://www.projectdivar.com/eventdata/t20")),c().get((0,d._)("http://www.projectdivar.com/eventdata/t50"))]);case 2:return n=e.sent,e.abrupt("return",n.map((function(e){return e.data})).reduce((function(e,n){return[].concat((0,s.Z)(e),(0,s.Z)(n))})).sort((function(e,n){return e.rank-n.rank})));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),f=t(7294),h=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1e3;return new Promise((function(n){return setTimeout(n,e)}))},x=(0,f.createContext)({}),m=function(e){var n=e.children,t=(0,f.useState)(),o=t[0],s=t[1],u=(0,f.useState)(),c=u[0],d=u[1],m=(0,f.useState)(2e4)[0];return(0,f.useEffect)((function(){var e=!1;(function(){var n=(0,a.Z)(i().mark((function n(){var t;return i().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(e){n.next=15;break}return n.prev=1,n.next=4,l();case 4:if(t=n.sent,!e){n.next=7;break}return n.abrupt("break",15);case 7:s(t),d(new Date);case 9:return n.prev=9,n.next=12,h(m);case 12:return n.finish(9);case 13:n.next=0;break;case 15:case"end":return n.stop()}}),n,null,[[1,,9,13]])})));return function(){return n.apply(this,arguments)}})()()}),[m]),(0,r.jsx)(x.Provider,{value:{lbData:o,lastUpdated:c},children:n})}},4693:function(e,n,t){"use strict";t.d(n,{b:function(){return s}});var r=t(809),o=t.n(r),i=t(2447),a=t(7294),s=function(e,n){(0,a.useEffect)((function(){var t=!1;return function(){var r=(0,i.Z)(o().mark((function r(){var i;return o().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,"function"===typeof e?e():e;case 2:if(i=r.sent,!t){r.next=5;break}return r.abrupt("return");case 5:n(i);case 6:case"end":return r.stop()}}),r)})));return function(){return r.apply(this,arguments)}}()(),function(){t=!0}}),[e,n])}},4279:function(e,n,t){"use strict";t.d(n,{a:function(){return r}});var r=function(e){return e<1e3?"".concat(e):e<1e6?"".concat(Math.round(e/1e3*100)/100,"k"):"".concat(Math.round(e/1e6*100)/100,"M")}},5301:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return t(4219)}])}},function(e){e.O(0,[774,809,351,777,757,879,139],(function(){return n=5301,e(e.s=n);var n}));var n=e.O();_N_E=n}]);