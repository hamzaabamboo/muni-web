(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[139],{7456:function(t,e,n){"use strict";n.d(e,{_:function(){return r}});var r=function(t){return t.match("projectdivar")?"https://hambot.ham-san.net/d4dj/sig?url="+encodeURIComponent(t):t.match("d4-dj")?"https://hambot.ham-san.net/d4dj/d4db?url="+encodeURIComponent(t):t}},6529:function(t,e,n){"use strict";n.d(e,{L:function(){return c}});var r=n(5893),u=n(4096),a=n(980),c=(n(7294),function(){return(0,r.jsx)(u.k,{w:"full",alignItems:"center",justifyContent:"center",h:"full",children:(0,r.jsx)(a.Spinner,{size:"xl"})})})},2974:function(t,e,n){"use strict";n.d(e,{M:function(){return s}});var r=n(5893),u=n(4096),a=n(4115),c=n(9490),o=n(7294),i=n(7216),s=function(){var t=(0,o.useContext)(i.A).event;return t?(0,r.jsxs)(u.k,{flexDirection:"column",children:[(0,r.jsx)(a.x,{fontWeight:"bold",fontSize:"3xl",textAlign:"center",children:t.name}),(0,r.jsx)(l,{startTime:t.startdate,rankEndTime:t.rank_end,resultsTime:t.rank_end})]}):null},l=function(t){var e=t.startTime,n=t.rankEndTime,i=t.resultsTime,s=(0,o.useState)("--:--"),l=s[0],f=s[1],d=(0,o.useState)(""),p=d[0],h=d[1],v=(0,o.useState)("-"),m=v[0],x=v[1],y=(0,o.useMemo)((function(){return Math.round(c.ou.fromISO(n).diff(c.ou.fromISO(e)).as("hours"))}),[e,n]);return(0,o.useEffect)((function(){var t=!1,r=function(){var r=c.ou.fromISO(n).diffNow(),u=c.ou.fromISO(i).diffNow(),a=Math.floor(c.ou.now().diff(c.ou.fromISO(e)).as("hours"));t||(r.as("hours")>0?(h("Time until end"),f(r.toFormat("hh:mm"))):u.as("hours")>0&&(h("Time until results"),f(u.toFormat("hh:mm"))),x("".concat(a>y?y:a," / ").concat(y," ").concat(a>y?"100":Math.round(a/y*100),"%")))};r();setInterval(r,3e4)}),[y]),(0,r.jsxs)(u.k,{flexDirection:"column",justifyContent:"center",children:[(0,r.jsxs)(a.x,{textAlign:"center",children:["Progress: ",m]}),(0,r.jsx)(a.x,{textAlign:"center",children:p}),(0,r.jsx)(a.x,{fontSize:"lg",fontWeight:"bold",textAlign:"center",children:l})]})}},7251:function(t,e,n){"use strict";n.d(e,{k:function(){return v}});var r=n(5893),u=n(4121),a=n(8347),c=n(7294),o=n(7424),i=n(9490),s=n(4279),l=n(4013),f=n(8017),d=n(6529),p=n(2594),h=500,v=function(t){var e=t.id,n=t.points,v=t.startDate,m=t.endDate,x=t.isLive,y=void 0!==x&&x,g=t.width,k=t.height,S=void 0===k?600:k,w=t.showTooltip,b=void 0!==w&&w,j=(0,a.Z)(t,["id","points","startDate","endDate","isLive","width","height","showTooltip"]),R=(0,c.useRef)(null),D=(0,c.useRef)(),I=(0,c.useRef)(),A=(0,c.useRef)(),O=(0,c.useRef)(),_=(0,c.useRef)(),E=(0,c.useRef)(),C=(0,c.useRef)(),T=(0,c.useRef)(),L=(0,c.useRef)(),Z=(0,c.useRef)(),M=(0,c.useRef)(),z=(0,c.useRef)(),N=(0,c.useRef)(o.YFb((function(t){return(0,o.ji_)(t.date)})).left),P=(0,c.useRef)(),F=(0,c.useRef)(),G=(0,c.useRef)(),J=(0,c.useRef)(),V=(0,l.G)(),X=j.isSmall||"base"===V||"sm"===V,U=(0,c.useMemo)((function(){return{top:20,right:20,bottom:30,left:X?45:60}}),[X]),K=(0,c.useMemo)((function(){var t=g-U.left-U.right;return t<0?0:t}),[U,g]),$=(0,c.useMemo)((function(){var t=S-U.top-U.bottom;return t<0?0:t}),[U,S]);function W(t){var e,n;z.current=t.transform,M.current=z.current.rescaleX(A.current),O.current=o.LLu(M.current),null===(e=P.current)||void 0===e||e.style("opacity",0),null===(n=G.current)||void 0===n||n.style("display","none"),H(),L.current.selectAll("path.line").attr("d",(function(t){return o.jvg().x((function(t){return M.current((0,o.ji_)(t.date))})).y((function(t){return _.current(t.points)}))(t[1])}))}(0,c.useEffect)((function(){return Z.current=o.sPX().scaleExtent([1,500]).extent([[0,0],[K,$]]).translateExtent([[0,-1/0],[K,1/0]]).on("zoom",W),D.current=o.Ys(R.current),I.current=D.current.append("svg").attr("width",K+U.left+U.right).attr("height",$+U.top+U.bottom).append("g").attr("transform","translate("+U.left+","+U.top+")"),A.current=o.Xf().range([0,K]),_.current=o.BYU().range([$,0]),M.current=A.current,T.current=I.current.append("clipPath").attr("id","clip-"+e).append("rect").attr("width",K).attr("height",$),I.current.append("g").attr("class","xAxis").attr("transform","translate(0,"+$+")"),I.current.append("g").attr("class","yAxis"),I.current.append("g").attr("class","xGrid").attr("transform","translate(0,"+$+")"),I.current.append("g").attr("class","yGrid"),O.current=o.LLu(A.current),E.current=o.y4O(_.current),C.current=o.PKp().range(Array(30).fill(null).map((function(t,e,n){return(0,o.OOA)(e/n.length)}))).domain(p.K),L.current=I.current.append("g").attr("clip-path","url(#clip-".concat(e,")")).attr("id","lines"),b&&(P.current=I.current.append("g").attr("class","tooltip").style("padding","2px").style("background-color","red"),F.current=P.current.append("line").style("stroke-width",1).style("stroke","grey"),G.current=D.current.append("div").style("display",null).style("position","absolute").style("pointer-events","none").style("padding","2px").style("background-color","lightgray").style("opacity",.8).style("z-index",3),G.current.append("p").style("font-size","0.9em"),G.current.append("ul").attr("class","scoreboard").style("font-size","0.75em").style("list-style-type","none")),function(){D.current.selectAll("*").remove()}}),[K,$,y,b]);var Y=(0,c.useCallback)((function(t){if(0!==n.length){var e=o.cx$(t),r=M.current.invert(e[0]),a=N.current(n,r,1);if(!n[a])return P.current.style("opacity",0),void G.current.style("display","none");P.current.style("opacity",1),G.current.style("display","block");var c=M.current((0,o.ji_)(n[a].date)),l=o.Xxj(n,(function(t){return t.rank})).sort((function(t,e){return t[0]-e[0]})).map((function(t){var e=(0,u.Z)(t,2),n=e[0],a=e[1];return[n,a[N.current(a,r,1)]]})).filter((function(t){return!!t[1]}));F.current.attr("y1",0).attr("y2",$).attr("x1",c).attr("x2",c);var f=o.cx$(t,D.current);G.current.selectAll("p").text(i.ou.fromJSDate(r).toFormat("HH:mm:ss DD")),G.current.style("left",f[0]+10+"px"),G.current.style("top",f[1]+"px");var d=G.current.select(".scoreboard").selectAll("li").data(l);d.enter().append("li"),d.exit().remove(),d.text((function(t){return"T".concat((0,s.a)(t[0]),": ").concat(t[1].points)}));var p=P.current.selectAll("circle").data(l,(function(t){return t[0]}));p.enter().append("circle").attr("class","point").attr("tier",(function(t){return t[0]})).attr("r",4),p.exit().remove(),p.attr("fill",(function(t){return C.current(t[0])})).attr("cx",c).attr("cy",(function(t){return _.current(t[1].points)}))}}),[$,n]);function B(){P.current.style("opacity",0),G.current.style("display","none")}(0,c.useEffect)((function(){return J.current=I.current.append("rect").style("fill","none").style("pointer-events","all").attr("width",K).attr("height",$),b&&J.current.on("mousemove",(function(t){Y(t)})).on("mouseout",B),y||J.current.call(Z.current),function(){J.current.remove()}}),[K,$,Y,b]);var H=(0,c.useCallback)((function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];I.current.select(".xGrid").attr("color","lightgray").transition().duration(t?h:0).call(o.LLu(M.current).tickSize(-$).tickFormat((function(){return""}))),I.current.select(".yGrid").attr("color","lightgray").transition().duration(t?h:0).call(o.y4O(_.current).tickSize(-K).tickFormat((function(){return""}))),I.current.select(".xAxis").transition().duration(t?h:0).call(O.current),I.current.select(".yAxis").transition().duration(t?h:0).call(X?E.current.tickFormat((function(t){return(0,s.a)(t)})):E.current)}),[$,K,X]);return(0,c.useEffect)((function(){var t=i.ou.now().plus({minutes:30}),e=i.ou.fromISO(v),r=i.ou.fromISO(m),u=y?v&&i.ou.now().minus({hour:3}).diff(e).as("second")<0?e.toJSDate():i.ou.now().minus({hour:3}).toJSDate():v?e.toJSDate():o.VV$(n,(function(t){return(0,o.ji_)(t.date)})),a=y&&i.ou.now().plus({minutes:30}).diff(r).as("seconds")>0?r:t,c=[u,a];A.current.domain(c),z.current&&(M.current=z.current.rescaleX(A.current),O.current=o.LLu(M.current)),_.current.domain([y?o.VV$(n.filter((function(t){return i.ou.fromISO(t.date).diff(i.ou.fromJSDate(u)).as("seconds")>0})),(function(t){return t.points})):0,o.Fp7(n,(function(t){return t.points}))]).nice();var s=o.Xxj(n,(function(t){return t.rank})),l=L.current.selectAll("path").data(s,(function(t){return t[0]}));l.enter().append("path").attr("class","line").attr("tier",(function(t){return t[0]})).attr("fill","none").attr("stroke",(function(t){return C.current(t[0])})).attr("stroke-width",2),l.exit().remove(),L.current.selectAll("path.line").transition().duration(h).attr("d",(function(t){return o.jvg().x((function(t){return M.current((0,o.ji_)(t.date))})).y((function(t){return _.current(t.points)}))(t[1])})),H(!0)}),[n,K,$,X,b]),0===K&&0===$?(0,r.jsx)(d.L,{}):(0,r.jsx)(f.xu,{ref:R})}},8024:function(t,e,n){"use strict";n.d(e,{W:function(){return i}});var r=n(5893),u=n(4096),a=n(8017),c=n(1664),o=n(1163),i=function(){var t=(0,o.useRouter)();return(0,r.jsxs)(u.k,{p:2,justifyContent:"center",children:[(0,r.jsx)(a.xu,{mx:4,p:2,rounded:"md",bg:"/"===t.pathname?"gray.200":"transparent",color:"/"===t.pathname?"blue.400":"black",fontSize:"lg",children:(0,r.jsx)(c.default,{href:"/",children:"Muniboard"})}),(0,r.jsx)(a.xu,{mx:4,p:2,rounded:"md",bg:"/graph"===t.pathname?"gray.200":"transparent",color:"/graph"===t.pathname?"blue.400":"black",fontSize:"lg",children:(0,r.jsx)(c.default,{href:"/graph",children:"Graph"})}),(0,r.jsx)(a.xu,{mx:4,p:2,rounded:"md",bg:"/live"===t.pathname?"gray.200":"transparent",color:"/live"===t.pathname?"blue.400":"black",fontSize:"lg",children:(0,r.jsx)(c.default,{href:"/live",children:"Live View"})})]})}},2594:function(t,e,n){"use strict";n.d(e,{X:function(){return r},K:function(){return u}});var r=[1,2,3,10,50,100,500,1e3,2e3,5e3,1e4,2e4,3e4,5e4],u=[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,50,100,500,1e3,2e3,5e3,1e4,2e4,3e4,5e4]},7216:function(t,e,n){"use strict";n.d(e,{A:function(){return v},d:function(){return m}});var r=n(5893),u=n(809),a=n.n(u),c=n(2447),o=n(9490),i=n(9669),s=n.n(i),l=n(7456),f=function(){var t=(0,c.Z)(a().mark((function t(e){var n;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,s().post((0,l._)("http://d4-dj-frontend.vercel.app/api/dbs"),{dbs:e});case 2:return n=t.sent,t.abrupt("return",e.map((function(t){return n.data.result[t]})));case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),d=function(){var t=(0,c.Z)(a().mark((function t(){var e,n;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,f(["EventMaster"]);case 2:return e=t.sent,n=Object.values(e[0]).find((function(t){return o.ou.fromSeconds(t.StartDate).diffNow().as("seconds")<0&&o.ou.fromSeconds(t.RankFixStartDate).diffNow().as("seconds")>0})),t.abrupt("return",{id:101,eventid:n.Id,name:n.Name,startdate:o.ou.fromSeconds(n.StartDate).toISO(),enddate:o.ou.fromSeconds(n.ResultAnnouncementDate).toISO(),rank_end:o.ou.fromSeconds(n.ReceptionCloseDate).toISO(),type:n.Type._name_});case 5:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),p=n(4693),h=n(7294),v=(0,h.createContext)({}),m=function(t){var e=t.children,n=(0,h.useState)(),u=n[0],a=n[1];return(0,p.b)(d,a),(0,r.jsx)(v.Provider,{value:{event:u},children:e})}},2965:function(t,e,n){"use strict";n.d(e,{V:function(){return m},U:function(){return x}});var r=n(5893),u=n(9999),a=n(809),c=n.n(a),o=n(2447),i=n(9669),s=n.n(i),l=n(7456),f=function(){var t=(0,o.Z)(c().mark((function t(){var e;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,s().get((0,l._)("http://www.projectdivar.com/eventdata/t20?all=true&event=14"));case 2:return e=t.sent,t.abrupt("return",e.data.sort((function(t,e){return t.id-e.id})));case 4:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),d=n(4693),p=n(9490),h=n(7294),v=n(3451),m=(0,h.createContext)({}),x=function(t){var e=t.children,n=(0,h.useContext)(v.G).lbData,a=(0,h.useState)([]),c=a[0],o=a[1],i=(0,h.useRef)({});return(0,d.b)(f,o),(0,h.useEffect)((function(){if(n){var t=n.filter((function(t){return!(i.current[t.rank]&&p.ou.fromISO(t.date).diff(i.current[t.rank]).as("seconds")<=0)&&(i.current[t.rank]=p.ou.fromISO(t.date),!0)}));t.length>0&&o((function(e){return[].concat((0,u.Z)(e),(0,u.Z)(t))}))}}),[n]),(0,r.jsx)(m.Provider,{value:{points:c},children:e})}},9538:function(t,e,n){"use strict";n.d(e,{B:function(){return i},Q:function(){return s}});var r=n(5893),u=n(4121),a=n(5492),c=n(7294),o=n(2965),i=(0,c.createContext)({}),s=function(t){var e=t.children,n=(0,c.useContext)(o.V).points,s=(0,a._)("displayTier",null),l=(0,u.Z)(s,2),f=l[0],d=l[1],p=(0,c.useState)([]),h=p[0],v=p[1];(0,c.useEffect)((function(){0===h.length&&v(Array.from(new Set(n.map((function(t){return t.rank})))))}),[n]);var m=(0,c.useMemo)((function(){return f?n.filter((function(t){return f.includes(t.rank)})):n}),[n,f]);return(0,r.jsx)(i.Provider,{value:{points:m,displayTier:f,setDisplayTier:d,allTiers:h},children:e})}},3451:function(t,e,n){"use strict";n.d(e,{G:function(){return h},K:function(){return v}});var r=n(5893),u=n(809),a=n.n(u),c=n(2447),o=n(9999),i=n(9669),s=n.n(i),l=n(7456),f=function(){var t=(0,c.Z)(a().mark((function t(){var e;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Promise.all([s().get((0,l._)("http://www.projectdivar.com/eventdata/t20")),s().get((0,l._)("http://www.projectdivar.com/eventdata/t50"))]);case 2:return e=t.sent,t.abrupt("return",e.map((function(t){return t.data})).reduce((function(t,e){return[].concat((0,o.Z)(t),(0,o.Z)(e))})).sort((function(t,e){return t.rank-e.rank})));case 4:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),d=n(7294),p=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1e3;return new Promise((function(e){return setTimeout(e,t)}))},h=(0,d.createContext)({}),v=function(t){var e=t.children,n=(0,d.useState)(),u=n[0],o=n[1],i=(0,d.useState)(),s=i[0],l=i[1],v=(0,d.useState)(2e4)[0];return(0,d.useEffect)((function(){var t=!1;(function(){var e=(0,c.Z)(a().mark((function e(){var n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=15;break}return e.prev=1,e.next=4,f();case 4:if(n=e.sent,!t){e.next=7;break}return e.abrupt("break",15);case 7:o(n),l(new Date);case 9:return e.prev=9,e.next=12,p(v);case 12:return e.finish(9);case 13:e.next=0;break;case 15:case"end":return e.stop()}}),e,null,[[1,,9,13]])})));return function(){return e.apply(this,arguments)}})()()}),[v]),(0,r.jsx)(h.Provider,{value:{lbData:u,lastUpdated:s},children:e})}},5492:function(t,e,n){"use strict";n.d(e,{_:function(){return o}});var r=n(7294),u=n(4047),a=n(2700),c=function(){function t(e){(0,u.Z)(this,t),this.key=e}return(0,a.Z)(t,[{key:"clear",value:function(){localStorage.removeItem(this.key)}},{key:"value",get:function(){try{var t=localStorage.getItem(this.key);return null!==t?JSON.parse(t):null}catch(e){return null}},set:function(t){if(null!==t){var e=JSON.stringify(t);localStorage.setItem(this.key,e)}else localStorage.removeItem(this.key)}}]),t}(),o=function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,u=new c(t),a=(0,r.useState)(u.value||n),o=a[0],i=a[1],s=function(t){var n="function"===typeof t?t.call(e,o):t;u.value=n,i(n)},l=function(t){return function(e){e.key===t&&i(JSON.parse(e.newValue||""))}};return(0,r.useEffect)((function(){return window.addEventListener("storage",l(t)),function(){window.removeEventListener("storage",l(t))}}),[t]),[o,s]}},4693:function(t,e,n){"use strict";n.d(e,{b:function(){return o}});var r=n(809),u=n.n(r),a=n(2447),c=n(7294),o=function(t,e){(0,c.useEffect)((function(){var n=!1;return function(){var r=(0,a.Z)(u().mark((function r(){var a;return u().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,"function"===typeof t?t():t;case 2:if(a=r.sent,!n){r.next=5;break}return r.abrupt("return");case 5:e(a);case 6:case"end":return r.stop()}}),r)})));return function(){return r.apply(this,arguments)}}()(),function(){n=!0}}),[t,e])}},4279:function(t,e,n){"use strict";n.d(e,{a:function(){return r}});var r=function(t){return t<1e3?"".concat(t):t<1e6?"".concat(Math.round(t/1e3*100)/100,"k"):"".concat(Math.round(t/1e6*100)/100,"M")}}}]);