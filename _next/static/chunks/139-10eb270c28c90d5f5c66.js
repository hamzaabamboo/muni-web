(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[139],{7456:function(t,n,e){"use strict";e.d(n,{_:function(){return r}});var r=function(t){return t.match("projectdivar")?"https://hambot.ham-san.net/d4dj/sig?url="+encodeURIComponent(t):t.match("d4-dj")?"https://hambot.ham-san.net/d4dj/d4db?url="+encodeURIComponent(t):t}},6529:function(t,n,e){"use strict";e.d(n,{L:function(){return c}});var r=e(5893),u=e(4096),a=e(980),c=(e(7294),function(){return(0,r.jsx)(u.k,{w:"full",alignItems:"center",justifyContent:"center",h:"full",children:(0,r.jsx)(a.Spinner,{size:"xl"})})})},2974:function(t,n,e){"use strict";e.d(n,{M:function(){return s}});var r=e(5893),u=e(4096),a=e(4115),c=e(9490),o=e(7294),i=e(7216),s=function(){var t=(0,o.useContext)(i.A).event;return t?(0,r.jsxs)(u.k,{flexDirection:"column",children:[(0,r.jsx)(a.x,{fontWeight:"bold",fontSize:"3xl",textAlign:"center",children:t.name}),(0,r.jsx)(f,{startTime:t.startdate,rankEndTime:t.rank_end,resultsTime:t.rank_end})]}):null},f=function(t){var n=t.startTime,e=t.rankEndTime,i=t.resultsTime,s=(0,o.useState)("--:--"),f=s[0],l=s[1],d=(0,o.useState)(""),p=d[0],h=d[1],m=(0,o.useState)("-"),v=m[0],x=m[1],g=(0,o.useMemo)((function(){return Math.round(c.ou.fromISO(e).diff(c.ou.fromISO(n)).as("hours"))}),[n,e]);return(0,o.useEffect)((function(){var t=!1,r=function(){var r=c.ou.fromISO(e).diffNow(),u=c.ou.fromISO(i).diffNow(),a=Math.floor(c.ou.now().diff(c.ou.fromISO(n)).as("hours"));t||(r.as("hours")>0?(h("Time until end"),l(r.toFormat("hh:mm"))):u.as("hours")>0&&(h("Time until results"),l(u.toFormat("hh:mm"))),x("".concat(a>g?g:a," / ").concat(g," ").concat(a>g?"100":Math.round(a/g*100),"%")))};r();setInterval(r,3e4)}),[g]),(0,r.jsxs)(u.k,{flexDirection:"column",justifyContent:"center",children:[(0,r.jsxs)(a.x,{textAlign:"center",children:["Progress: ",v]}),(0,r.jsx)(a.x,{textAlign:"center",children:p}),(0,r.jsx)(a.x,{fontSize:"lg",fontWeight:"bold",textAlign:"center",children:f})]})}},7251:function(t,n,e){"use strict";e.d(n,{k:function(){return d}});var r=e(5893),u=e(8347),a=e(7294),c=e(9801),o=e(9490),i=e(4279),s=e(4013),f=e(6529),l=500,d=function(t){var n=t.id,e=t.points,d=t.startDate,p=t.endDate,h=t.isLive,m=void 0!==h&&h,v=t.width,x=t.height,g=void 0===x?600:x,k=(0,u.Z)(t,["id","points","startDate","endDate","isLive","width","height"]),S=(0,a.useRef)(null),w=(0,a.useRef)(),b=(0,a.useRef)(),j=(0,a.useRef)(),y=(0,a.useRef)(),I=(0,a.useRef)(),D=(0,a.useRef)(),O=(0,a.useRef)(),R=(0,a.useRef)(),_=(0,a.useRef)(),E=(0,a.useRef)(),A=(0,a.useRef)(),C=(0,s.G)(),L=k.isSmall||"base"===C||"sm"===C,M=(0,a.useMemo)((function(){return{top:20,right:20,bottom:30,left:L?45:60}}),[L]),T=(0,a.useMemo)((function(){var t=v-M.left-M.right;return t<0?0:t}),[M,v]),Z=(0,a.useMemo)((function(){var t=g-M.top-M.bottom;return t<0?0:t}),[M,g]);function N(t){A.current=t.transform,E.current=A.current.rescaleX(b.current),j.current=c.LLu(E.current),P(),R.current.selectAll("path.line").attr("d",(function(t){return c.jvg().x((function(t){return E.current((0,c.ji_)(t.date))})).y((function(t){return y.current(t.points)}))(t[1])}))}(0,a.useEffect)((function(){c.Ys(S.current).selectAll("*").remove(),_.current=c.sPX().scaleExtent([1,500]).extent([[0,0],[T,Z]]).translateExtent([[0,-1/0],[T,1/0]]).on("zoom",N),w.current=c.Ys(S.current).attr("width",T+M.left+M.right).attr("height",Z+M.top+M.bottom).append("g").attr("transform","translate("+M.left+","+M.top+")"),b.current=c.Xf().range([0,T]),y.current=c.BYU().range([Z,0]),E.current=b.current,O.current=w.current.append("clipPath").attr("id","clip-"+n).append("rect").attr("width",T).attr("height",Z),w.current.append("g").attr("class","xAxis").attr("transform","translate(0,"+Z+")"),w.current.append("g").attr("class","yAxis"),w.current.append("g").attr("class","xGrid").attr("transform","translate(0,"+Z+")"),w.current.append("g").attr("class","yGrid"),j.current=c.LLu(b.current),I.current=c.y4O(y.current),D.current=c.PKp().range(["#e41a1c","#377eb8","#4daf4a","#984ea3","#ff7f00","#ffff33","#a65628","#f781bf","#999999"]),R.current=w.current.append("g").attr("clip-path","url(#clip-".concat(n,")")).attr("id","lines"),m||c.Ys(S.current).call(_.current)}),[T,Z,m]);var P=(0,a.useCallback)((function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];w.current.select(".xGrid").attr("color","lightgray").transition().duration(t?l:0).call(c.LLu(E.current).tickSize(-Z).tickFormat((function(){return""}))),w.current.select(".yGrid").attr("color","lightgray").transition().duration(t?l:0).call(c.y4O(y.current).tickSize(-T).tickFormat((function(){return""}))),w.current.select(".xAxis").transition().duration(t?l:0).call(j.current),w.current.select(".yAxis").transition().duration(t?l:0).call(L?I.current.tickFormat((function(t){return(0,i.a)(t)})):I.current)}),[Z,T,L]);return(0,a.useEffect)((function(){var t=o.ou.now().plus({minutes:30}),n=o.ou.fromISO(d),r=o.ou.fromISO(p),u=m?d&&o.ou.now().minus({hour:3}).diff(n).as("second")<0?n.toJSDate():o.ou.now().minus({hour:3}).toJSDate():d?n.toJSDate():c.VV$(e,(function(t){return(0,c.ji_)(t.date)})),a=m&&o.ou.now().plus({minutes:30}).diff(r).as("seconds")>0?r:t,i=[u,a];D.current=D.current.domain(new Set(e.map((function(t){return t.rank})))),b.current.domain(i),A.current&&(E.current=A.current.rescaleX(b.current),j.current=c.LLu(E.current)),y.current.domain([m?c.VV$(e.filter((function(t){return o.ou.fromISO(t.date).diff(o.ou.fromJSDate(u)).as("seconds")>0})),(function(t){return t.points})):0,c.Fp7(e,(function(t){return t.points}))]).nice();var s=c.Xxj(e,(function(t){return t.rank})),f=R.current.selectAll("path").data(s,(function(t){return t[0]}));f.enter().append("path").attr("class","line").attr("tier",(function(t){return t[0]})).attr("fill","none").attr("stroke",(function(t){return D.current(t[0])})).attr("stroke-width",2),f.exit().remove(),R.current.selectAll("path.line").transition().duration(l).attr("d",(function(t){return c.jvg().x((function(t){return E.current((0,c.ji_)(t.date))})).y((function(t){return y.current(t.points)}))(t[1])})),P(!0)}),[e,T,Z,L]),0===T&&0===Z?(0,r.jsx)(f.L,{}):(0,r.jsx)("svg",{ref:S})}},8024:function(t,n,e){"use strict";e.d(n,{W:function(){return i}});var r=e(5893),u=e(4096),a=e(8017),c=e(1664),o=e(1163),i=function(){var t=(0,o.useRouter)();return(0,r.jsxs)(u.k,{p:2,justifyContent:"center",children:[(0,r.jsx)(a.xu,{mx:4,p:2,rounded:"md",bg:"/"===t.pathname?"gray.200":"transparent",color:"/"===t.pathname?"blue.400":"black",fontSize:"lg",children:(0,r.jsx)(c.default,{href:"/",children:"Muniboard"})}),(0,r.jsx)(a.xu,{mx:4,p:2,rounded:"md",bg:"/graph"===t.pathname?"gray.200":"transparent",color:"/graph"===t.pathname?"blue.400":"black",fontSize:"lg",children:(0,r.jsx)(c.default,{href:"/graph",children:"Graph"})}),(0,r.jsx)(a.xu,{mx:4,p:2,rounded:"md",bg:"/live"===t.pathname?"gray.200":"transparent",color:"/live"===t.pathname?"blue.400":"black",fontSize:"lg",children:(0,r.jsx)(c.default,{href:"/live",children:"Live View"})})]})}},7216:function(t,n,e){"use strict";e.d(n,{A:function(){return m},d:function(){return v}});var r=e(5893),u=e(809),a=e.n(u),c=e(2447),o=e(9490),i=e(9669),s=e.n(i),f=e(7456),l=function(){var t=(0,c.Z)(a().mark((function t(n){var e;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,s().post((0,f._)("http://d4-dj-frontend.vercel.app/api/dbs"),{dbs:n});case 2:return e=t.sent,t.abrupt("return",n.map((function(t){return e.data.result[t]})));case 4:case"end":return t.stop()}}),t)})));return function(n){return t.apply(this,arguments)}}(),d=function(){var t=(0,c.Z)(a().mark((function t(){var n,e;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,l(["EventMaster"]);case 2:return n=t.sent,e=Object.values(n[0]).find((function(t){return o.ou.fromSeconds(t.StartDate).diffNow().as("seconds")<0&&o.ou.fromSeconds(t.RankFixStartDate).diffNow().as("seconds")>0})),t.abrupt("return",{id:101,eventid:e.Id,name:e.Name,startdate:o.ou.fromSeconds(e.StartDate).toISO(),enddate:o.ou.fromSeconds(e.ResultAnnouncementDate).toISO(),rank_end:o.ou.fromSeconds(e.ReceptionCloseDate).toISO(),type:e.Type._name_});case 5:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),p=e(4693),h=e(7294),m=(0,h.createContext)({}),v=function(t){var n=t.children,e=(0,h.useState)(),u=e[0],a=e[1];return(0,p.b)(d,a),(0,r.jsx)(m.Provider,{value:{event:u},children:n})}},2965:function(t,n,e){"use strict";e.d(n,{V:function(){return v},U:function(){return x}});var r=e(5893),u=e(9999),a=e(809),c=e.n(a),o=e(2447),i=e(9669),s=e.n(i),f=e(7456),l=function(){var t=(0,o.Z)(c().mark((function t(){var n;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,s().get((0,f._)("http://www.projectdivar.com/eventdata/t20?all=true&event=14"));case 2:return n=t.sent,t.abrupt("return",n.data.sort((function(t,n){return t.id-n.id})));case 4:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),d=e(4693),p=e(9490),h=e(7294),m=e(3451),v=(0,h.createContext)({}),x=function(t){var n=t.children,e=(0,h.useContext)(m.G).lbData,a=(0,h.useState)([]),c=a[0],o=a[1],i=(0,h.useRef)({});return(0,d.b)(l,o),(0,h.useEffect)((function(){if(e){var t=e.filter((function(t){return!(i.current[t.rank]&&p.ou.fromISO(t.date).diff(i.current[t.rank]).as("seconds")<=0)&&(i.current[t.rank]=p.ou.fromISO(t.date),!0)}));t.length>0&&o((function(n){return[].concat((0,u.Z)(n),(0,u.Z)(t))}))}}),[e]),(0,r.jsx)(v.Provider,{value:{points:c},children:n})}},9538:function(t,n,e){"use strict";e.d(n,{B:function(){return i},Q:function(){return s}});var r=e(5893),u=e(4121),a=e(5492),c=e(7294),o=e(2965),i=(0,c.createContext)({}),s=function(t){var n=t.children,e=(0,c.useContext)(o.V).points,s=(0,a._)("displayTier",null),f=(0,u.Z)(s,2),l=f[0],d=f[1],p=(0,c.useState)([]),h=p[0],m=p[1];(0,c.useEffect)((function(){0===h.length&&m(Array.from(new Set(e.map((function(t){return t.rank})))))}),[e]);var v=(0,c.useMemo)((function(){return l?e.filter((function(t){return l.includes(t.rank)})):e}),[e,l]);return(0,r.jsx)(i.Provider,{value:{points:v,displayTier:l,setDisplayTier:d,allTiers:h},children:n})}},3451:function(t,n,e){"use strict";e.d(n,{G:function(){return h},K:function(){return m}});var r=e(5893),u=e(809),a=e.n(u),c=e(2447),o=e(9999),i=e(9669),s=e.n(i),f=e(7456),l=function(){var t=(0,c.Z)(a().mark((function t(){var n;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Promise.all([s().get((0,f._)("http://www.projectdivar.com/eventdata/t20")),s().get((0,f._)("http://www.projectdivar.com/eventdata/t50"))]);case 2:return n=t.sent,t.abrupt("return",n.map((function(t){return t.data})).reduce((function(t,n){return[].concat((0,o.Z)(t),(0,o.Z)(n))})).sort((function(t,n){return t.rank-n.rank})));case 4:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),d=e(7294),p=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1e3;return new Promise((function(n){return setTimeout(n,t)}))},h=(0,d.createContext)({}),m=function(t){var n=t.children,e=(0,d.useState)(),u=e[0],o=e[1],i=(0,d.useState)(),s=i[0],f=i[1],m=(0,d.useState)(2e4)[0];return(0,d.useEffect)((function(){var t=!1;(function(){var n=(0,c.Z)(a().mark((function n(){var e;return a().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(t){n.next=15;break}return n.prev=1,n.next=4,l();case 4:if(e=n.sent,!t){n.next=7;break}return n.abrupt("break",15);case 7:o(e),f(new Date);case 9:return n.prev=9,n.next=12,p(m);case 12:return n.finish(9);case 13:n.next=0;break;case 15:case"end":return n.stop()}}),n,null,[[1,,9,13]])})));return function(){return n.apply(this,arguments)}})()()}),[m]),(0,r.jsx)(h.Provider,{value:{lbData:u,lastUpdated:s},children:n})}},5492:function(t,n,e){"use strict";e.d(n,{_:function(){return o}});var r=e(7294),u=e(4047),a=e(2700),c=function(){function t(n){(0,u.Z)(this,t),this.key=n}return(0,a.Z)(t,[{key:"clear",value:function(){localStorage.removeItem(this.key)}},{key:"value",get:function(){try{var t=localStorage.getItem(this.key);return null!==t?JSON.parse(t):null}catch(n){return null}},set:function(t){if(null!==t){var n=JSON.stringify(t);localStorage.setItem(this.key,n)}else localStorage.removeItem(this.key)}}]),t}(),o=function(t){var n=this,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,u=new c(t),a=(0,r.useState)(u.value||e),o=a[0],i=a[1],s=function(t){var e="function"===typeof t?t.call(n,o):t;u.value=e,i(e)},f=function(t){return function(n){n.key===t&&i(JSON.parse(n.newValue||""))}};return(0,r.useEffect)((function(){return window.addEventListener("storage",f(t)),function(){window.removeEventListener("storage",f(t))}}),[t]),[o,s]}},4693:function(t,n,e){"use strict";e.d(n,{b:function(){return o}});var r=e(809),u=e.n(r),a=e(2447),c=e(7294),o=function(t,n){(0,c.useEffect)((function(){var e=!1;return function(){var r=(0,a.Z)(u().mark((function r(){var a;return u().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,"function"===typeof t?t():t;case 2:if(a=r.sent,!e){r.next=5;break}return r.abrupt("return");case 5:n(a);case 6:case"end":return r.stop()}}),r)})));return function(){return r.apply(this,arguments)}}()(),function(){e=!0}}),[t,n])}},4279:function(t,n,e){"use strict";e.d(n,{a:function(){return r}});var r=function(t){return t<1e3?"".concat(t):t<1e6?"".concat(Math.round(t/1e3*100)/100,"k"):"".concat(Math.round(t/1e6*100)/100,"M")}}}]);