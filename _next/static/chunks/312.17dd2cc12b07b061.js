"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[312],{9312:function(e,n,r){r.r(n),r.d(n,{Towaland:function(){return w}});var t=r(8520),i=r.n(t),a=r(5893),o=r(5115),u=r(7294),c=r(3451),l=r(5277),s=r(9838),d=(r(356),r(5193)),h=r(1391),f=r(8142),v=r(3451);function m(e,n,r,t,i,a,o){try{var u=e[a](o),c=u.value}catch(l){return void r(l)}u.done?n(c):Promise.resolve(c).then(t,i)}function p(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,n){var r=[],t=!0,i=!1,a=void 0;try{for(var o,u=e[Symbol.iterator]();!(t=(o=u.next()).done)&&(r.push(o.value),!n||r.length!==n);t=!0);}catch(c){i=!0,a=c}finally{try{t||null==u.return||u.return()}finally{if(i)throw a}}return r}(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var w=function(){var e=(0,u.useRef)(),n=(0,u.useRef)(null),r=p((0,l.tH)(n),2),t=r[0],w=r[1],g=(0,u.useState)(0),k=g[0],y=g[1],M=(0,u.useState)("hello"),j=M[0],S=M[1],C=(0,u.useRef)(),_=(0,u.useRef)();return(0,u.useEffect)((function(){e.current=new c.Application({transparent:!0,width:t,height:w,autoStart:!0});var r,a=e.current;return s.Live2DModel.registerTicker(c.Ticker),n.current.appendChild(a.view),(r=i().mark((function e(){var n,r,t,o,u;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Promise((function(e){return a.loader.add("towa",(0,f.Z)("spine/spine_chara_0330001.json")).add("muni",(0,f.Z)("spine/spine_chara_0130001.json")).load((function(n,r){e(r)}))}));case 2:if(n=e.sent,0!==k){e.next=7;break}r=new v.spine.Spine(n.towa.spineData),t=new v.spine.Spine(n.muni.spineData),r.skeleton.setSkinByName("normal"),t.skeleton.setSkinByName("reverse"),console.log(t.skeleton.slots.map((function(e){return e}))),t.skeleton.findSlot("Rabbit ears_L(for)").setAttachment(null),t.skeleton.findSlot("Rabbit ears_R(for)").setAttachment(null),o=2*r.width>a.renderer.width?a.renderer.width/3/r.width:r.height>a.renderer.height?a.renderer.height/r.height:1,r.scale.x=o,r.scale.y=o,t.scale.x=-1*o,t.scale.y=o,r.x=.2*a.renderer.width,r.y=a.renderer.height,t.x=.8*a.renderer.width,t.y=a.renderer.height,r.state.setAnimation(0,"06_talk_A",!0),t.state.setAnimation(0,"07_talk_B",!0),a.stage.addChild(r),a.stage.addChild(t),e.next=30;break;case 7:return e.next=9,s.Live2DModel.from((0,f.Z)("live2d/towa/resources.model3.json"));case 9:return C.current=e.sent,e.next=12,s.Live2DModel.from((0,f.Z)("live2d/muni/resources.model3.json"));case 12:_.current=e.sent,u=C.current.height/2>a.renderer.height?3*a.renderer.height/C.current.height:C.current.width>3*a.renderer.width/4?a.renderer.width/C.current.width:1,C.current.x=.25*a.renderer.width,C.current.y=9*a.renderer.height/10,C.current.rotation=Math.PI,C.current.skew.x=Math.PI,C.current.scale.set(-1*u,u),C.current.anchor.set(.5,.5),_.current.x=.75*a.renderer.width,_.current.y=9*a.renderer.height/10,_.current.rotation=Math.PI,_.current.skew.x=Math.PI,_.current.scale.set(u,u),_.current.anchor.set(.5,.5),C.current.internalModel.motionManager.startRandomMotion(""),_.current.internalModel.motionManager.startRandomMotion(""),a.stage.addChild(C.current),a.stage.addChild(_.current);case 30:case"end":return e.stop()}}),e)})),function(){var e=this,n=arguments;return new Promise((function(t,i){var a=r.apply(e,n);function o(e){m(a,t,i,o,u,"next",e)}function u(e){m(a,t,i,o,u,"throw",e)}o(void 0)}))})(),function(){var e;null===(e=n.current)||void 0===e||e.removeChild(a.view)}}),[t,w,k]),(0,u.useEffect)((function(){var e,n;C.current&&_.current&&(null===(e=C.current)||void 0===e||e.motion("",x(C.current,j)),null===(n=_.current)||void 0===n||n.motion("",x(_.current,j)));return function(){var e,n;null===(e=C.current)||void 0===e||e.internalModel.motionManager.stopAllMotions(),null===(n=_.current)||void 0===n||n.internalModel.motionManager.stopAllMotions()}}),[j]),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(o.kC,{flexDir:["column",null,"row"],alignItems:"center",children:[(0,a.jsxs)(d.hE,{isAttached:!0,variant:"solid",children:[(0,a.jsx)(d.zx,{colorScheme:0===k?"blue":"whitealpha",variant:0===k?"solid":"outline",onClick:function(){return y(0)},children:"Spine"}),(0,a.jsx)(d.zx,{colorScheme:1===k?"blue":"whitealpha",variant:1===k?"solid":"outline",onClick:function(){return y(1)},children:"Live2D"})]}),1===k&&(0,a.jsxs)(o.kC,{alignItems:"center",px:2,children:[(0,a.jsx)(o.xv,{whiteSpace:"nowrap",children:"Pose"}),(0,a.jsx)(h.Ph,{onChange:function(e){return S(e.currentTarget.value)},value:j,children:["idle","happy","sad","angry","dance","yes","no","cry","amazed","shame","think","question","performance","waver","panic"].map((function(e){return(0,a.jsx)("option",{value:e,children:e},e)}))}),(0,a.jsx)(o.xv,{whiteSpace:"nowrap",children:"(Doesn't make sense though)"})]})]}),(0,a.jsx)(o.kC,{minH:"990px",w:"full",flex:"1",ref:n})]})};n.default=w;var x=function(e,n){var r;return null!==(r=e.internalModel.settings.motions[""].map((function(e,r){return e.File.match(n)?r:void 0})).filter((function(e){return e}))[0])&&void 0!==r?r:0}}}]);