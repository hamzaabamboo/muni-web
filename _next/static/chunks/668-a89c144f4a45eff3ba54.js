(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[668],{7456:function(t,e,n){"use strict";n.d(e,{_:function(){return r}});var r=function(t){return t.match("projectdivar")?"https://hambot.ham-san.net/d4dj/sig?url="+encodeURIComponent(t):t.match("d4-dj")?"https://hambot.ham-san.net/d4dj/d4db?url="+encodeURIComponent(t):t}},2974:function(t,e,n){"use strict";n.d(e,{M:function(){return s}});var r=n(5893),u=n(4096),a=n(4115),i=n(9490),o=n(7294),c=n(7216),s=function(){var t=(0,o.useContext)(c.A).event;return t?(0,r.jsxs)(u.k,{flexDirection:"column",children:[(0,r.jsx)(a.x,{fontWeight:"bold",fontSize:"3xl",textAlign:"center",children:t.name}),(0,r.jsx)(f,{startTime:t.startdate,rankEndTime:t.rank_end,resultsTime:t.rank_end})]}):null},f=function(t){var e=t.startTime,n=t.rankEndTime,c=t.resultsTime,s=(0,o.useState)("--:--"),f=s[0],l=s[1],d=(0,o.useState)(""),p=d[0],h=d[1],m=(0,o.useState)("-"),v=m[0],x=m[1],g=(0,o.useMemo)((function(){return Math.round(i.ou.fromISO(n).diff(i.ou.fromISO(e)).as("hours"))}),[e,n]);return(0,o.useEffect)((function(){var t=!1,r=function(){var r=i.ou.fromISO(n).diffNow(),u=i.ou.fromISO(c).diffNow(),a=Math.floor(i.ou.now().diff(i.ou.fromISO(e)).as("hours"));t||(r.as("hours")>0?(h("Time until end"),l(r.toFormat("hh:mm"))):u.as("hours")>0&&(h("Time until results"),l(u.toFormat("hh:mm"))),x("".concat(a>g?g:a," / ").concat(g," ").concat(a>g?"100":Math.round(a/g*100),"%")))};r();setInterval(r,3e4)}),[g]),(0,r.jsxs)(u.k,{flexDirection:"column",justifyContent:"center",children:[(0,r.jsxs)(a.x,{textAlign:"center",children:["Progress: ",v]}),(0,r.jsx)(a.x,{textAlign:"center",children:p}),(0,r.jsx)(a.x,{fontSize:"lg",fontWeight:"bold",textAlign:"center",children:f})]})}},8024:function(t,e,n){"use strict";n.d(e,{W:function(){return c}});var r=n(5893),u=n(4096),a=n(8017),i=n(1664),o=n(1163),c=function(){var t=(0,o.useRouter)();return(0,r.jsxs)(u.k,{p:2,justifyContent:"center",children:[(0,r.jsx)(a.xu,{mx:4,p:2,rounded:"md",bg:"/"===t.pathname?"gray.200":"transparent",color:"/"===t.pathname?"blue.400":"black",fontSize:"lg",children:(0,r.jsx)(i.default,{href:"/",children:"Muniboard"})}),(0,r.jsx)(a.xu,{mx:4,p:2,rounded:"md",bg:"/graph"===t.pathname?"gray.200":"transparent",color:"/graph"===t.pathname?"blue.400":"black",fontSize:"lg",children:(0,r.jsx)(i.default,{href:"/graph",children:"Graph"})}),(0,r.jsx)(a.xu,{mx:4,p:2,rounded:"md",bg:"/live"===t.pathname?"gray.200":"transparent",color:"/live"===t.pathname?"blue.400":"black",fontSize:"lg",children:(0,r.jsx)(i.default,{href:"/live",children:"Live View"})})]})}},6887:function(t,e,n){"use strict";n.d(e,{q:function(){return h}});var r=n(5893),u=n(7294),a=n(7216),i=n(7710),o=n(8347),c=n(9801),s=n(9490),f=n(4279),l=n(4013),d=500,p=function(t){var e=t.points,n=t.startDate,a=t.endDate,i=t.isLive,p=void 0!==i&&i,h=t.width,m=t.height,v=void 0===m?600:m,x=(0,o.Z)(t,["points","startDate","endDate","isLive","width","height"]),g=(0,u.useRef)(),b=(0,u.useRef)(),k=(0,u.useRef)(),S=(0,u.useRef)(),w=(0,u.useRef)(),y=(0,u.useRef)(),j=(0,u.useRef)(),D=(0,u.useRef)(),I=(0,u.useRef)(),T=(0,u.useRef)(),C=(0,u.useRef)(),O=(0,l.G)(),A=x.isSmall||"base"===O||"sm"===O,R=(0,u.useMemo)((function(){return{top:20,right:20,bottom:30,left:A?45:60}}),[A]),_=(0,u.useMemo)((function(){var t=h-R.left-R.right;return t<0?0:t}),[R,h]),E=(0,u.useMemo)((function(){var t=v-R.top-R.bottom;return t<0?0:t}),[R,v]);function L(t){C.current=t.transform,T.current=C.current.rescaleX(b.current),k.current=c.LLu(T.current),M(),D.current.selectAll("path.line").attr("d",(function(t){return c.jvg().x((function(t){return T.current((0,c.ji_)(t.date))})).y((function(t){return S.current(t.points)}))(t[1])}))}(0,u.useEffect)((function(){c.Ys("#lbgraph").selectAll("*").remove(),I.current=c.sPX().scaleExtent([1,500]).extent([[0,0],[_,E]]).translateExtent([[0,-1/0],[_,1/0]]).on("zoom",L),g.current=c.Ys("#lbgraph").attr("width",_+R.left+R.right).attr("height",E+R.top+R.bottom).append("g").attr("transform","translate("+R.left+","+R.top+")"),b.current=c.Xf().range([0,_]),S.current=c.BYU().range([E,0]),T.current=b.current,j.current=g.current.append("clipPath").attr("id","graph").append("rect").attr("width",_).attr("height",E),g.current.append("g").attr("class","xAxis").attr("transform","translate(0,"+E+")"),g.current.append("g").attr("class","yAxis"),g.current.append("g").attr("class","xGrid").attr("transform","translate(0,"+E+")"),g.current.append("g").attr("class","yGrid"),k.current=c.LLu(b.current),w.current=c.y4O(S.current),y.current=c.PKp().range(["#e41a1c","#377eb8","#4daf4a","#984ea3","#ff7f00","#ffff33","#a65628","#f781bf","#999999"]),D.current=g.current.append("g").attr("clip-path","url(#graph)").attr("id","lines"),p||c.Ys("#lbgraph").call(I.current)}),[_,E,p]);var M=(0,u.useCallback)((function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];g.current.select(".xGrid").attr("color","lightgray").transition().duration(t?d:0).call(c.LLu(T.current).tickSize(-E).tickFormat((function(){return""}))),g.current.select(".yGrid").attr("color","lightgray").transition().duration(t?d:0).call(c.y4O(S.current).tickSize(-_).tickFormat((function(){return""}))),g.current.select(".xAxis").transition().duration(t?d:0).call(k.current),g.current.select(".yAxis").transition().duration(t?d:0).call(A?w.current.tickFormat((function(t){return(0,f.a)(t)})):w.current)}),[E,_,A]);return(0,u.useEffect)((function(){var t=s.ou.now().plus({minutes:30}),r=s.ou.fromISO(n),u=s.ou.fromISO(a),i=p?n&&s.ou.now().minus({hour:3}).diff(r).as("second")<0?r.toJSDate():s.ou.now().minus({hour:3}).toJSDate():n?r.toJSDate():c.VV$(e,(function(t){return(0,c.ji_)(t.date)})),o=p&&s.ou.now().plus({minutes:30}).diff(u).as("seconds")>0?u:t,f=[i,o];y.current=y.current.domain(new Set(e.map((function(t){return t.rank})))),b.current.domain(f),C.current&&(T.current=C.current.rescaleX(b.current),k.current=c.LLu(T.current)),S.current.domain([p?c.VV$(e.filter((function(t){return s.ou.fromISO(t.date).diff(s.ou.fromJSDate(i)).as("seconds")>0})),(function(t){return t.points})):0,c.Fp7(e,(function(t){return t.points}))]).nice();var l=c.Xxj(e,(function(t){return t.rank})),h=D.current.selectAll("path").data(l,(function(t){return t[0]}));h.enter().append("path").attr("class","line").attr("tier",(function(t){return t[0]})).attr("fill","none").attr("stroke",(function(t){return y.current(t[0])})).attr("stroke-width",2),h.exit().remove(),D.current.selectAll("path.line").transition().duration(d).attr("d",(function(t){return c.jvg().x((function(t){return T.current((0,c.ji_)(t.date))})).y((function(t){return S.current(t.points)}))(t[1])})),M(!0)}),[e,_,E,A]),(0,r.jsx)("svg",{id:"lbgraph"})},h=function(t){var e=t.width,n=t.height,o=t.isSmall,c=void 0!==o&&o,s=t.isLive,f=void 0!==s&&s,l=(0,u.useContext)(i.V).points,d=(0,u.useContext)(a.A).event;return(0,r.jsx)(p,{points:l,startDate:null===d||void 0===d?void 0:d.startdate,endDate:null===d||void 0===d?void 0:d.rank_end,width:e,height:n,isSmall:c,isLive:f})}},4263:function(t,e,n){"use strict";n.d(e,{I:function(){return s}});var r=n(5893),u=n(9999),a=n(6185),i=n(4096),o=n(7294),c=n(7710),s=function(){var t=(0,o.useContext)(c.V),e=t.displayTier,n=t.setDisplayTier,s=t.allTiers,f=(0,o.useMemo)((function(){return[{label:"Select All",tiers:s},{label:"Clear",tiers:[]},{label:"< T10",tiers:s.filter((function(t){return t<=10}))},{label:"< T20",tiers:s.filter((function(t){return t<=20}))},{label:"< T100",tiers:s.filter((function(t){return t<=100}))},{label:"> T500",tiers:s.filter((function(t){return t>=500}))}]}),[s]);return(0,r.jsxs)(i.k,{w:"full",flexWrap:"wrap",mx:"auto",children:[f.map((function(t){return(0,r.jsx)(a.z,{m:2,bg:"blue.200",onClick:function(){return n(t.tiers)},children:t.label},t.label)})),s.sort((function(t,e){return t-e})).map((function(t){return(0,r.jsxs)(a.z,{m:2,bg:null!==e&&void 0!==e&&e.includes(t)?"green.200":"gray.200",onClick:function(){return function(t){if(null!==e&&void 0!==e&&e.includes(t))return n((function(e){return e.filter((function(e){return e!==t}))}));n((function(e){return[].concat((0,u.Z)(e),[t])}))}(t)},children:["T",t]},t)}))]})}},7216:function(t,e,n){"use strict";n.d(e,{A:function(){return m},d:function(){return v}});var r=n(5893),u=n(809),a=n.n(u),i=n(2447),o=n(9490),c=n(9669),s=n.n(c),f=n(7456),l=function(){var t=(0,i.Z)(a().mark((function t(e){var n;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,s().post((0,f._)("http://d4-dj-frontend.vercel.app/api/dbs"),{dbs:e});case 2:return n=t.sent,t.abrupt("return",e.map((function(t){return n.data.result[t]})));case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),d=function(){var t=(0,i.Z)(a().mark((function t(){var e,n;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,l(["EventMaster"]);case 2:return e=t.sent,n=Object.values(e[0]).find((function(t){return o.ou.fromSeconds(t.StartDate).diffNow().as("seconds")<0&&o.ou.fromSeconds(t.RankFixStartDate).diffNow().as("seconds")>0})),t.abrupt("return",{id:101,eventid:n.Id,name:n.Name,startdate:o.ou.fromSeconds(n.StartDate).toISO(),enddate:o.ou.fromSeconds(n.ResultAnnouncementDate).toISO(),rank_end:o.ou.fromSeconds(n.ReceptionCloseDate).toISO(),type:n.Type._name_});case 5:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),p=n(4693),h=n(7294),m=(0,h.createContext)({}),v=function(t){var e=t.children,n=(0,h.useState)(),u=n[0],a=n[1];return(0,p.b)(d,a),(0,r.jsx)(m.Provider,{value:{event:u},children:e})}},7710:function(t,e,n){"use strict";n.d(e,{V:function(){return k},U:function(){return S}});var r=n(5893),u=n(9999),a=n(4121),i=n(809),o=n.n(i),c=n(2447),s=n(9669),f=n.n(s),l=n(7456),d=function(){var t=(0,c.Z)(o().mark((function t(){var e;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,f().get((0,l._)("http://www.projectdivar.com/eventdata/t20?all=true&event=14"));case 2:return e=t.sent,t.abrupt("return",e.data.sort((function(t,e){return t.id-e.id})));case 4:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),p=n(7294),h=n(4047),m=n(2700),v=function(){function t(e){(0,h.Z)(this,t),this.key=e}return(0,m.Z)(t,[{key:"clear",value:function(){localStorage.removeItem(this.key)}},{key:"value",get:function(){try{var t=localStorage.getItem(this.key);return null!==t?JSON.parse(t):null}catch(e){return null}},set:function(t){if(null!==t){var e=JSON.stringify(t);localStorage.setItem(this.key,e)}else localStorage.removeItem(this.key)}}]),t}(),x=n(4693),g=n(9490),b=n(3451),k=(0,p.createContext)({}),S=function(t){var e=t.children,n=(0,p.useContext)(b.G).lbData,i=(0,p.useState)([]),o=i[0],c=i[1],s=function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=new v(t),u=(0,p.useState)(r.value||n),a=u[0],i=u[1],o=function(t){var n="function"===typeof t?t.call(e,a):t;r.value=n,i(n)},c=function(t){return function(e){e.key===t&&i(JSON.parse(e.newValue||""))}};return(0,p.useEffect)((function(){return window.addEventListener("storage",c(t)),function(){window.removeEventListener("storage",c(t))}}),[t]),[a,o]}("displayTier",null),f=(0,a.Z)(s,2),l=f[0],h=f[1],m=(0,p.useState)([]),S=m[0],w=m[1],y=(0,p.useRef)({}),j=(0,p.useCallback)((function(t){var e=Array.from(new Set(t.map((function(t){return t.rank}))));w(e),null===l&&h(e),c(t)}),[]);(0,x.b)(d,j),(0,p.useEffect)((function(){if(n){var t=n.filter((function(t){return!(y.current[t.rank]&&g.ou.fromISO(t.date).diff(y.current[t.rank]).as("seconds")<=0)&&(y.current[t.rank]=g.ou.fromISO(t.date),!0)}));t.length>0&&c((function(e){return[].concat((0,u.Z)(e),(0,u.Z)(t))}))}}),[n]);var D=(0,p.useMemo)((function(){return l?o.filter((function(t){return l.includes(t.rank)})):o}),[o,l]);return(0,r.jsx)(k.Provider,{value:{points:D,displayTier:l,setDisplayTier:h,allTiers:S},children:e})}},3451:function(t,e,n){"use strict";n.d(e,{G:function(){return h},K:function(){return m}});var r=n(5893),u=n(809),a=n.n(u),i=n(2447),o=n(9999),c=n(9669),s=n.n(c),f=n(7456),l=function(){var t=(0,i.Z)(a().mark((function t(){var e;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Promise.all([s().get((0,f._)("http://www.projectdivar.com/eventdata/t20")),s().get((0,f._)("http://www.projectdivar.com/eventdata/t50"))]);case 2:return e=t.sent,t.abrupt("return",e.map((function(t){return t.data})).reduce((function(t,e){return[].concat((0,o.Z)(t),(0,o.Z)(e))})).sort((function(t,e){return t.rank-e.rank})));case 4:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),d=n(7294),p=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1e3;return new Promise((function(e){return setTimeout(e,t)}))},h=(0,d.createContext)({}),m=function(t){var e=t.children,n=(0,d.useState)(),u=n[0],o=n[1],c=(0,d.useState)(),s=c[0],f=c[1],m=(0,d.useState)(2e4)[0];return(0,d.useEffect)((function(){var t=!1;(function(){var e=(0,i.Z)(a().mark((function e(){var n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=15;break}return e.prev=1,e.next=4,l();case 4:if(n=e.sent,!t){e.next=7;break}return e.abrupt("break",15);case 7:o(n),f(new Date);case 9:return e.prev=9,e.next=12,p(m);case 12:return e.finish(9);case 13:e.next=0;break;case 15:case"end":return e.stop()}}),e,null,[[1,,9,13]])})));return function(){return e.apply(this,arguments)}})()()}),[m]),(0,r.jsx)(h.Provider,{value:{lbData:u,lastUpdated:s},children:e})}},4693:function(t,e,n){"use strict";n.d(e,{b:function(){return o}});var r=n(809),u=n.n(r),a=n(2447),i=n(7294),o=function(t,e){(0,i.useEffect)((function(){var n=!1;return function(){var r=(0,a.Z)(u().mark((function r(){var a;return u().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,"function"===typeof t?t():t;case 2:if(a=r.sent,!n){r.next=5;break}return r.abrupt("return");case 5:e(a);case 6:case"end":return r.stop()}}),r)})));return function(){return r.apply(this,arguments)}}()(),function(){n=!0}}),[t,e])}},4279:function(t,e,n){"use strict";n.d(e,{a:function(){return r}});var r=function(t){return t<1e3?"".concat(t):t<1e6?"".concat(Math.round(t/1e3*100)/100,"k"):"".concat(Math.round(t/1e6*100)/100,"M")}}}]);